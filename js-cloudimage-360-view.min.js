var CI360=function(){"use strict";var on=Object.defineProperty;var sn=(Q,W,at)=>W in Q?on(Q,W,{enumerable:!0,configurable:!0,writable:!0,value:at}):Q[W]=at;var ei=(Q,W,at)=>sn(Q,typeof W!="symbol"?W+"":W,at);var Q=document.createElement("style");Q.textContent=`:root{--ci360-button-bg: rgba(255, 255, 255, .9);--ci360-button-bg-hover: rgba(255, 255, 255, 1);--ci360-button-size: 40px;--ci360-button-border-radius: 6px;--ci360-button-shadow: 0 2px 8px rgba(0, 0, 0, .15);--ci360-icon-color: #505050;--ci360-icon-color-hover: #333333;--ci360-icon-size: 20px;--ci360-initial-icon-bg: rgba(255, 255, 255, .9);--ci360-initial-icon-color: #505050;--ci360-initial-icon-size: 80px;--ci360-initial-icon-shadow: 0 4px 20px rgba(0, 0, 0, .15);--ci360-spinner-color: rgba(0, 0, 0, .2);--ci360-spinner-accent: #505050;--ci360-spinner-size: 30px;--ci360-fullscreen-bg: #ffffff;--ci360-magnifier-size: 250px;--ci360-magnifier-border: 2px solid rgba(0, 0, 0, .2);--ci360-magnifier-shadow: 0 8px 16px rgba(0, 0, 0, .3);--ci360-focus-color: #0066cc;--ci360-overlay-bg: rgba(255, 255, 255, 1);--ci360-hotspot-color: #00aaff;--ci360-hotspot-border: 2px solid #fff;--ci360-hotspot-size: 18px;--ci360-popper-bg: rgba(255, 255, 255, .95);--ci360-popper-color: #333;--ci360-popper-shadow: 0px 4px 16px rgba(0, 0, 0, .15);--ci360-popper-border-radius: 8px;--ci360-hints-bg: rgba(255, 255, 255, .9);--ci360-hints-color: #333333;--ci360-hints-font-size: 13px;--ci360-hints-border-radius: 20px;--ci360-hints-shadow: 0 2px 12px rgba(0, 0, 0, .1);--ci360-circle-color: #888888;--ci360-timeline-height: 6px;--ci360-timeline-track-bg: rgba(0, 0, 0, .12);--ci360-timeline-dot-size: 18px;--ci360-timeline-dot-color: var(--ci360-hotspot-color);--ci360-timeline-dot-border: 2px solid #fff;--ci360-timeline-indicator-size: 12px;--ci360-timeline-indicator-color: #333333;--ci360-timeline-tooltip-bg: rgba(255, 255, 255, .95);--ci360-timeline-tooltip-color: #333333}.ci360-theme-dark{--ci360-button-bg: rgba(40, 40, 45, .9);--ci360-button-bg-hover: rgba(55, 55, 60, .95);--ci360-button-shadow: 0 2px 8px rgba(0, 0, 0, .4);--ci360-icon-color: #e0e0e0;--ci360-icon-color-hover: #ffffff;--ci360-initial-icon-bg: rgba(40, 40, 45, .9);--ci360-initial-icon-color: #f5f5f5;--ci360-initial-icon-shadow: 0 4px 20px rgba(0, 0, 0, .4);--ci360-spinner-color: rgba(255, 255, 255, .2);--ci360-spinner-accent: #e0e0e0;--ci360-fullscreen-bg: #1a1a1f;--ci360-overlay-bg: rgba(26, 26, 31, 1);--ci360-magnifier-border: 2px solid rgba(255, 255, 255, .2);--ci360-magnifier-shadow: 0 8px 16px rgba(0, 0, 0, .5);--ci360-popper-bg: rgba(40, 40, 45, .95);--ci360-popper-color: #e0e0e0;--ci360-popper-shadow: 0px 4px 16px rgba(0, 0, 0, .4);--ci360-hints-bg: rgba(40, 40, 45, .9);--ci360-hints-color: #e0e0e0;--ci360-hints-shadow: 0 2px 12px rgba(0, 0, 0, .3);--ci360-circle-color: #b0b0b0;--ci360-timeline-track-bg: rgba(255, 255, 255, .15);--ci360-timeline-dot-border: 2px solid rgba(255, 255, 255, .9);--ci360-timeline-indicator-color: #e0e0e0;--ci360-timeline-tooltip-bg: rgba(40, 40, 45, .95);--ci360-timeline-tooltip-color: #e0e0e0}@keyframes rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.cloudimage-360{width:100%;position:relative}.cloudimage-360-inner-box{width:100%;height:100%;position:relative}.cloudimage-360-icons-container{position:absolute;display:flex;top:15px;right:10px;height:100%;flex-direction:column;align-items:center;z-index:100;gap:8px}.cloudimage-360-transition-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--ci360-overlay-bg);opacity:0;transition:all 1s ease-out;z-index:10}.cloudimage-360-button{width:var(--ci360-button-size);height:var(--ci360-button-size);cursor:pointer;transition:transform .15s ease-out,background-color .15s ease-out,box-shadow .15s ease-out;display:flex;align-items:center;justify-content:center;border-radius:var(--ci360-button-border-radius);border:none;background-color:var(--ci360-button-bg);box-shadow:var(--ci360-button-shadow);padding:6px;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}.cloudimage-360-button:hover{transform:scale(1.05);background-color:var(--ci360-button-bg-hover)}.cloudimage-360-button:focus{outline:none}.cloudimage-360-button:focus-visible{outline:2px solid var(--ci360-focus-color);outline-offset:2px}.cloudimage-360-button svg{width:var(--ci360-icon-size);height:var(--ci360-icon-size);stroke:var(--ci360-icon-color);transition:stroke .15s ease-out}.cloudimage-360-button:hover svg{stroke:var(--ci360-icon-color-hover)}.cloudimage-initial-icon{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:var(--ci360-initial-icon-size);height:var(--ci360-initial-icon-size);border-radius:50%;background-color:var(--ci360-initial-icon-bg);box-shadow:var(--ci360-initial-icon-shadow);transition:all .3s ease;color:var(--ci360-initial-icon-color);display:flex;align-items:center;justify-content:center;z-index:2;-webkit-user-select:none;-moz-user-select:none;user-select:none;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}.cloudimage-initial-icon svg{width:70%;height:70%;color:var(--ci360-initial-icon-color);fill:var(--ci360-initial-icon-color);stroke:var(--ci360-initial-icon-color)}.cloudimage-initial-icon svg path{stroke:var(--ci360-initial-icon-color)}.cloudimage-initial-icon svg text{fill:var(--ci360-initial-icon-color)}.cloudimage-initial-icon:hover{transform:translate(-50%,-50%) scale(1.08)}.cloudimage-loading-spinner{width:var(--ci360-spinner-size);height:var(--ci360-spinner-size);transform:translate(-50%,-50%);border:3px solid var(--ci360-spinner-color);position:absolute;top:15px;left:15px;border-bottom-color:var(--ci360-spinner-accent);border-radius:50%;display:inline-block;box-sizing:border-box;opacity:0;animation:rotation .7s linear infinite}.cloudimage-360-view-360-circle{position:absolute;left:0;bottom:0;width:100%;height:auto;margin:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:.2s all;z-index:2;color:var(--ci360-circle-color)}.cloudimage-360-view-360-circle svg{display:block;width:100%;height:auto}.cloudimage-360-fullscreen-modal{position:fixed;top:0;bottom:0;left:0;right:0;width:100%;height:100%;z-index:999;background-color:var(--ci360-fullscreen-bg)}.cloudimage-360-sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.cloudimage-360-hints-overlay{position:absolute;bottom:0;left:0;width:100%;display:flex;align-items:flex-end;justify-content:center;padding-bottom:16px;z-index:50;pointer-events:none;opacity:0;transition:opacity .3s ease}.cloudimage-360-hints-overlay.visible{opacity:1}.cloudimage-360-hints-overlay.hiding{opacity:0}.cloudimage-360-hints-container{display:flex;flex-direction:row;gap:20px;padding:10px 20px;background:var(--ci360-hints-bg);border-radius:var(--ci360-hints-border-radius);box-shadow:var(--ci360-hints-shadow);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}.cloudimage-360-hint-item{display:flex;align-items:center;gap:8px;color:var(--ci360-hints-color);font-size:var(--ci360-hints-font-size);font-family:system-ui,-apple-system,sans-serif;white-space:nowrap}.cloudimage-360-hint-item svg{width:16px;height:16px;flex-shrink:0;stroke:var(--ci360-hints-color)}.cloudimage-360-hint-item span{opacity:.9}@media (max-width: 480px){.cloudimage-360-hints-container{flex-direction:column;gap:8px;padding:12px 16px;border-radius:12px}.cloudimage-360-hint-item{font-size:12px}.cloudimage-360-hint-item svg{width:14px;height:14px}.cloudimage-360-initial-icon{width:calc(var(--ci360-initial-icon-size) * .8);height:calc(var(--ci360-initial-icon-size) * .8)}}.cloudimage-360-img-magnifier-glass{background-color:#fff;background-image:radial-gradient(circle at center,#fffc,#f0f0f0e6);background-repeat:no-repeat;position:absolute;border:var(--ci360-magnifier-border);border-radius:50%;line-height:200px;text-align:center;z-index:1000;width:var(--ci360-magnifier-size);height:var(--ci360-magnifier-size);top:-75px;right:-85px;box-shadow:var(--ci360-magnifier-shadow);transition:box-shadow .2s ease;overflow:hidden;pointer-events:none}.cloudimage-360-hotspot-timeline{width:100%;max-width:500px;margin:16px auto 8px;padding:12px 20px;opacity:0;transition:opacity .3s ease;pointer-events:none}.cloudimage-360-hotspot-timeline.visible{opacity:1;pointer-events:auto}.cloudimage-360-hotspot-timeline-track{position:relative;width:100%;height:var(--ci360-timeline-height);background:var(--ci360-timeline-track-bg);border-radius:calc(var(--ci360-timeline-height) / 2)}.cloudimage-360-hotspot-timeline-indicator{position:absolute;top:50%;left:0;width:var(--ci360-timeline-indicator-size);height:var(--ci360-timeline-indicator-size);background:var(--ci360-timeline-indicator-color);border-radius:50%;transform:translate(-50%,-50%);transition:left .1s ease-out;pointer-events:none;box-shadow:0 2px 4px #0003}.cloudimage-360-hotspot-timeline-dot{position:absolute;top:50%;width:var(--ci360-timeline-dot-size);height:var(--ci360-timeline-dot-size);background:var(--ci360-timeline-dot-color);border:var(--ci360-timeline-dot-border);border-radius:50%;transform:translate(-50%,-50%);cursor:pointer;transition:transform .15s ease,box-shadow .15s ease;box-shadow:0 2px 6px #00000040;padding:0;font:inherit;outline:none}.cloudimage-360-hotspot-timeline-dot:hover{transform:translate(-50%,-50%) scale(1.25);box-shadow:0 3px 10px #0000004d}.cloudimage-360-hotspot-timeline-dot:focus-visible{outline:2px solid var(--ci360-focus-color);outline-offset:2px}.cloudimage-360-hotspot-timeline-tooltip{position:absolute;bottom:calc(100% + 10px);left:50%;transform:translate(-50%);background:var(--ci360-timeline-tooltip-bg);color:var(--ci360-timeline-tooltip-color);padding:6px 12px;border-radius:6px;font-size:13px;font-weight:500;white-space:nowrap;opacity:0;visibility:hidden;transition:opacity .2s ease,visibility .2s ease;pointer-events:none;box-shadow:0 2px 8px #00000026;z-index:10}.cloudimage-360-hotspot-timeline-tooltip:after{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:6px solid transparent;border-top-color:var(--ci360-timeline-tooltip-bg)}.cloudimage-360-hotspot-timeline-tooltip.visible{opacity:1;visibility:visible}@media (max-width: 480px){.cloudimage-360-hotspot-timeline{max-width:none;padding:10px 16px;margin:12px auto 6px}}.cloudimage-360-hotspot-container{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;z-index:20}.cloudimage-360-popper{opacity:1;transition:opacity .2s ease-in-out}.cloudimage-360-hotspot{display:inline-block;position:absolute;top:0;right:0;bottom:0;left:0;transform:translate(-50%,-50%);background:var(--ci360-hotspot-color);border:var(--ci360-hotspot-border);border-radius:50%;height:var(--ci360-hotspot-size);width:var(--ci360-hotspot-size);box-shadow:0 0 #0af9,0 2px 6px #0003;opacity:0;animation:pulse 2s infinite;transition:transform .2s ease,box-shadow .2s ease;padding:0;cursor:pointer;font:inherit;outline:none}.cloudimage-360-hotspot:focus-visible{outline:2px solid var(--ci360-focus-color, #0066cc);outline-offset:2px;animation:none}.cloudimage-360-hotspot.visible{opacity:1}@keyframes pulse{0%{transform:scale(1);box-shadow:0 0 #0af9,0 0 0 10px #0af6,0 0 0 20px #0af3}50%{transform:scale(1.1);box-shadow:0 0 0 10px #0af0,0 0 0 20px #00aaff1a,0 0 0 30px #0af0}to{transform:scale(1);box-shadow:0 0 #0af0,0 0 0 10px #0af0,0 0 0 20px #0af0}}.cloudimage-360-hotspot:hover{transform:scale(1.2);box-shadow:0 0 0 5px #00aaff80,0 4px 12px #0000004d}.cloudimage-360-popper{background-color:var(--ci360-popper-bg);color:var(--ci360-popper-color);padding:10px 15px;border-radius:var(--ci360-popper-border-radius);box-shadow:var(--ci360-popper-shadow);font-size:14px;max-width:220px;z-index:9999;text-align:center;transition:opacity .2s ease,translate .2s ease;opacity:0;translate:0 -10px}.cloudimage-360-popper[data-show]{opacity:1;translate:0}
/*$vite$:1*/`,document.head.appendChild(Q);var W=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var he="Expected a function",de=NaN,ii="[object Symbol]",oi=/^\s+|\s+$/g,si=/^[-+]0x[0-9a-f]+$/i,ni=/^0b[01]+$/i,ri=/^0o[0-7]+$/i,ai=parseInt,li=typeof W=="object"&&W&&W.Object===Object&&W,ci=typeof self=="object"&&self&&self.Object===Object&&self,hi=li||ci||Function("return this")(),di=Object.prototype,pi=di.toString,ui=Math.max,fi=Math.min,$t=function(){return hi.Date.now()};function mi(e,t,i){var o,s,n,l,r,a,c=0,h=!1,p=!1,m=!0;if(typeof e!="function")throw new TypeError(he);t=pe(t)||0,Rt(i)&&(h=!!i.leading,p="maxWait"in i,n=p?ui(pe(i.maxWait)||0,t):n,m="trailing"in i?!!i.trailing:m);function u(f){var g=o,I=s;return o=s=void 0,c=f,l=e.apply(I,g),l}function x(f){return c=f,r=setTimeout(k,t),h?u(f):l}function y(f){var g=f-a,I=f-c,E=t-g;return p?fi(E,n-I):E}function v(f){var g=f-a,I=f-c;return a===void 0||g>=t||g<0||p&&I>=n}function k(){var f=$t();if(v(f))return O(f);r=setTimeout(k,y(f))}function O(f){return r=void 0,m&&o?u(f):(o=s=void 0,l)}function w(){r!==void 0&&clearTimeout(r),c=0,o=a=s=r=void 0}function b(){return r===void 0?l:O($t())}function C(){var f=$t(),g=v(f);if(o=arguments,s=this,a=f,g){if(r===void 0)return x(a);if(p)return r=setTimeout(k,t),u(a)}return r===void 0&&(r=setTimeout(k,t)),l}return C.cancel=w,C.flush=b,C}function vi(e,t,i){var o=!0,s=!0;if(typeof e!="function")throw new TypeError(he);return Rt(i)&&(o="leading"in i?!!i.leading:o,s="trailing"in i?!!i.trailing:s),mi(e,t,{leading:o,maxWait:t,trailing:s})}function Rt(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function gi(e){return!!e&&typeof e=="object"}function bi(e){return typeof e=="symbol"||gi(e)&&pi.call(e)==ii}function pe(e){if(typeof e=="number")return e;if(bi(e))return de;if(Rt(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Rt(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(oi,"");var i=ni.test(e);return i||ri.test(e)?ai(e.slice(2),i?2:8):si.test(e)?de:+e}var yi=vi;const ue=at(yi),R={SPIN_X:"spin-x",SPIN_Y:"spin-y",SPIN_XY:"spin-xy",SPIN_YX:"spin-yx"},wi=[!1,0,null,void 0,"false","0","null","undefined"],Y={X:"x-axis",Y:"y-axis"},xi=[37,39],Ii=[38,40],fe=typeof navigator<"u"&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?32:10,Ci=150,me=800,ki=150,Oi=200,ve=50,Ei=50,Ai=5,ge=5,d={folder:"/",apiVersion:"v7",filenameX:"image-{index}.jpg",filenameY:null,imageListX:null,imageListY:null,indexZeroBase:0,amountX:0,amountY:0,speed:80,dragSpeed:150,draggable:!0,swipeable:!0,keys:!1,keysReverse:!1,autoplay:!1,autoplayBehavior:R.SPIN_X,playOnce:!1,autoplayReverse:!1,pointerZoom:0,fullscreen:!1,magnifier:null,bottomCircle:!0,bottomCircleOffset:5,ciToken:null,ciFilters:null,ciTransformation:null,lazyload:!0,dragReverse:!1,stopAtEdges:!1,imageInfo:!1,initialIconShown:!0,hotspots:null,hotspotTrigger:"hover",hide360Logo:!1,logoSrc:"https://scaleflex.cloudimg.io/v7/filerobot/js-cloudimage-360-view/360_view.svg",inertia:!1,pinchZoom:!0,hints:!0,theme:null,hotspotTimelineOnClick:!0,aspectRatio:null,onReady:null,onLoad:null,onSpin:null,onAutoplayStart:null,onAutoplayStop:null,onFullscreenOpen:null,onFullscreenClose:null,onZoomIn:null,onZoomOut:null,onDragStart:null,onDragEnd:null},Si=e=>({folder:S(e,"folder",d.folder),apiVersion:S(e,"api-version",d.apiVersion),filenameX:S(e,"filename")||S(e,"filename-x")||d.filenameX,filenameY:S(e,"filename-y",d.filenameY),imageListX:S(e,"image-list-x",d.imageListX),imageListY:S(e,"image-list-y",d.imageListY),indexZeroBase:parseInt(S(e,"index-zero-base",d.indexZeroBase),10),amountX:parseInt(S(e,"amount-x",d.amountX),10),amountY:parseInt(S(e,"amount-y",d.amountY),10),speed:parseInt(S(e,"speed",d.speed),10),dragSpeed:parseInt(S(e,"drag-speed",d.dragSpeed),10),draggable:P(e,"draggable",d.draggable),swipeable:P(e,"swipeable",d.swipeable),keys:P(e,"keys",d.keys),keysReverse:P(e,"keys-reverse",d.keysReverse),autoplay:P(e,"autoplay",d.autoplay),autoplayBehavior:S(e,"autoplay-behavior",d.autoplayBehavior),playOnce:P(e,"play-once",d.playOnce),autoplayReverse:P(e,"autoplay-reverse",d.autoplayReverse),pointerZoom:parseFloat(S(e,"pointer-zoom",d.pointerZoom)),fullscreen:P(e,"fullscreen")||P(e,"full-screen",d.fullscreen),magnifier:parseFloat(S(e,"magnifier",d.magnifier)),bottomCircleOffset:parseInt(S(e,"bottom-circle-offset",d.bottomCircleOffset),10),ciToken:S(e,"responsive",d.ciToken),ciFilters:S(e,"filters",d.ciFilters),ciTransformation:S(e,"transformation",d.ciTransformation),lazyload:P(e,"lazyload",d.lazyload),dragReverse:P(e,"drag-reverse",d.dragReverse),stopAtEdges:P(e,"stop-at-edges",d.stopAtEdges),imageInfo:P(e,"info",d.imageInfo),initialIconShown:!Mt(e,"initial-icon"),bottomCircle:!Mt(e,"bottom-circle"),hide360Logo:P(e,"hide-360-logo",d.hide360Logo),logoSrc:S(e,"logo-src",d.logoSrc),inertia:P(e,"inertia",d.inertia),pinchZoom:P(e,"pinch-zoom",d.pinchZoom),hints:!Mt(e,"hints"),theme:S(e,"theme",d.theme),hotspotTrigger:S(e,"hotspot-trigger",d.hotspotTrigger),hotspotTimelineOnClick:!Mt(e,"hotspot-timeline-on-click"),aspectRatio:S(e,"aspect-ratio",d.aspectRatio)}),Li=e=>{const t=[];e.amountX!==void 0&&e.amountX<0&&t.push("amountX should be a positive number"),e.amountY!==void 0&&e.amountY<0&&t.push("amountY should be a positive number"),e.speed!==void 0&&e.speed<=0&&t.push("speed should be a positive number"),e.dragSpeed!==void 0&&e.dragSpeed<=0&&t.push("dragSpeed should be a positive number"),e.pointerZoom!==void 0&&e.pointerZoom!==0&&(e.pointerZoom<1||e.pointerZoom>5)&&t.push("pointerZoom should be between 1 and 5 (or 0 to disable)"),e.magnifier!==void 0&&e.magnifier!==null&&e.magnifier!==0&&(e.magnifier<1||e.magnifier>5)&&t.push("magnifier should be between 1 and 5 (or 0/null to disable)"),!e.folder&&!e.imageListX&&!e.imageListY&&t.push("Either folder or imageListX/imageListY is required"),e.folder&&!e.amountX&&!e.imageListX&&t.push("amountX is required when using folder (unless imageListX is provided)");const i=["spin-x","spin-y","spin-xy","spin-yx"];return e.autoplayBehavior&&!i.includes(e.autoplayBehavior)&&t.push(`autoplayBehavior should be one of: ${i.join(", ")}`),t.forEach(o=>{console.warn(`CloudImage 360: ${o}`)}),t.length===0},Ti=e=>(Li(e),{folder:e.folder||d.folder,apiVersion:e.apiVersion||d.apiVersion,filenameX:e.filenameX||e.filename||d.filenameX,filenameY:e.filenameY||d.filenameY,imageListX:e.imageListX||d.imageListX,imageListY:e.imageListY||d.imageListY,indexZeroBase:parseInt(e.indexZeroBase??d.indexZeroBase,10),amountX:parseInt(e.amountX??d.amountX,10),amountY:parseInt(e.amountY??d.amountY,10),speed:parseInt(e.speed??d.speed,10),draggable:e.draggable??d.draggable,swipeable:e.swipeable??d.swipeable,dragSpeed:parseInt(e.dragSpeed??d.dragSpeed,10),keys:e.keys??d.keys,keysReverse:e.keysReverse??d.keysReverse,autoplay:e.autoplay??d.autoplay,autoplayBehavior:e.autoplayBehavior||d.autoplayBehavior,playOnce:e.playOnce??d.playOnce,autoplayReverse:e.autoplayReverse??d.autoplayReverse,pointerZoom:parseFloat(e.pointerZoom??d.pointerZoom),fullscreen:e.fullscreen??d.fullscreen,magnifier:parseFloat(e.magnifier??d.magnifier),bottomCircleOffset:parseInt(e.bottomCircleOffset??d.bottomCircleOffset,10),ciToken:e.ciToken||d.ciToken,ciFilters:e.ciFilters||d.ciFilters,ciTransformation:e.ciTransformation||d.ciTransformation,lazyload:e.lazyload??d.lazyload,dragReverse:e.dragReverse??d.dragReverse,stopAtEdges:e.stopAtEdges??d.stopAtEdges,imageInfo:e.imageInfo??d.imageInfo,initialIconShown:e.initialIconShown??d.initialIconShown,bottomCircle:e.bottomCircle??d.bottomCircle,hotspots:e.hotspots??d.hotspots,hotspotTrigger:e.hotspotTrigger||d.hotspotTrigger,hide360Logo:e.hide360Logo??d.hide360Logo,logoSrc:e.logoSrc||d.logoSrc,inertia:e.inertia??d.inertia,pinchZoom:e.pinchZoom??d.pinchZoom,hints:e.hints??d.hints,theme:e.theme||d.theme,hotspotTimelineOnClick:e.hotspotTimelineOnClick??d.hotspotTimelineOnClick,aspectRatio:e.aspectRatio||d.aspectRatio,onReady:e.onReady??d.onReady,onLoad:e.onLoad??d.onLoad,onSpin:e.onSpin??d.onSpin,onAutoplayStart:e.onAutoplayStart??d.onAutoplayStart,onAutoplayStop:e.onAutoplayStop??d.onAutoplayStop,onFullscreenOpen:e.onFullscreenOpen??d.onFullscreenOpen,onFullscreenClose:e.onFullscreenClose??d.onFullscreenClose,onZoomIn:e.onZoomIn??d.onZoomIn,onZoomOut:e.onZoomOut??d.onZoomOut,onDragStart:e.onDragStart??d.onDragStart,onDragEnd:e.onDragEnd??d.onDragEnd}),S=(e,t,i)=>e.getAttribute(t)||e.getAttribute(`data-${t}`)||i,P=(e,t,i)=>{if(!(e.hasAttribute(t)||e.hasAttribute(`data-${t}`)))return i;const s=S(e,t,null);return s!=="false"&&s!=="0"},Mt=(e,t)=>S(e,t,null)==="false",Yi=(e=1)=>{const t=Math.round(window.devicePixelRatio||1);return parseInt(e)*t},Pi=(e,t,i)=>new URL(e).origin.includes("cloudimg")?e:`https://${t}.cloudimg.io/${i}${e}`,Xi=({ciTransformation:e,responsiveWidth:t,ciFilters:i})=>{const o=`width=${t}`,s=e||o,n=i?`&f=${i}`:"";return`${s}${n}`},bt=(e,t)=>{const{folder:i,apiVersion:o,filename:s="",ciParams:n}=e,{ciToken:l,ciFilters:r,ciTransformation:a}=n||{},c=`${i}${s}`;if(!l||!t)return c;const h=wi.includes(o)?null:o,p=h?`${h}/`:"",m=Yi(t),u=Pi(c,l,p),x=Xi({ciTransformation:a,responsiveWidth:m,ciFilters:r});return`${u}${x?"?":""}${x}`},Ri=(e,t,i)=>{const[o,s]=e.split("?"),n=`${t}=${encodeURIComponent(i)}`;if(!s)return`${o}?${n}`;const l=new URLSearchParams(s);return l.set(t,i),`${o}?${l.toString()}`},Mi=(e,t)=>Ri(e,"width",t),be=(e,t=0)=>(e+="",e.length>=t?e:new Array(t-e.length+1).join("0")+e),Hi=(e,{amount:t=0,indexZeroBase:i=0}={})=>Array.from({length:t},(o,s)=>e.replace("{index}",be(s+1,i))),Di=typeof navigator<"u"&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?3:6,Zi=({imagesUrls:e,onFirstImageLoad:t,onImageLoad:i,onAllImagesLoad:o,onError:s,autoplayReverse:n})=>{let l=0,r=0;const a=e.length,c=[],h=[];let p=0,m=0;const u=[],x=(f,g,I=!1)=>{const E={message:`Failed to load image: ${f}`,url:f,index:g,isFirstImage:I};h.push(E),r++,s==null||s({error:E,errorCount:r,totalImages:a,errors:h})},y=()=>{l===a&&(o==null||o(c,{errorCount:r,errors:h}))},v=()=>{for(;p<Di&&m<u.length;){const f=u[m];m++,k(e[f],f)}},k=(f,g)=>{p++;const I=new Image;I.crossOrigin="anonymous",I.src=f,I.onload=async()=>{try{const E=await createImageBitmap(I),A={src:f,bitmapImage:E,naturalWidth:I.naturalWidth,naturalHeight:I.naturalHeight};I.onload=null,I.onerror=null,I.src="",l++,p--,c[g]=A,i==null||i(A,g),y(),v()}catch{I.onload=null,I.onerror=null,I.src="",l++,p--,x(f,g),y(),v()}},I.onerror=()=>{I.onload=null,I.onerror=null,I.src="",l++,p--,x(f,g),y(),v()}},O=f=>{for(let g=0;g<e.length;g++)g!==f&&u.push(g);m=0,v()},w=new Image,b=n?e.length-1:0,C=e[b];w.crossOrigin="anonymous",w.src=C,w.onload=async()=>{try{const f=await createImageBitmap(w),g={src:C,bitmapImage:f,naturalWidth:w.naturalWidth,naturalHeight:w.naturalHeight};w.onload=null,w.onerror=null,w.src="",c[b]=g,l++,t==null||t(g),i==null||i(g,b),a===1?y():O(b)}catch{w.onload=null,w.onerror=null,w.src="",l++,x(C,b,!0),a===1?y():O(b)}},w.onerror=()=>{w.onload=null,w.onerror=null,w.src="",l++,x(C,b,!0),a===1?y():O(b)}},ye=({cdnPathX:e,cdnPathY:t,configX:i,configY:o,onFirstImageLoad:s,onImageLoad:n,onAllImagesLoad:l,onError:r})=>{let a={x:!1,y:!1},c=[],h=[],p={errorCount:0,errors:[]},m={errorCount:0,errors:[]};const u=e||i.imageList.length,x=t||o.imageList.length,y=()=>{if(a.x&&a.y){const k={errorCount:p.errorCount+m.errorCount,errors:[...p.errors,...m.errors]};l==null||l(c,h,k)}},v=({cdnPath:k,config:O,orientation:w,loadedImages:b,loadStats:C,onFirstImageLoad:f})=>{const g=w===Y.X,I=O.imageList.length?O.imageList:Hi(k,O);Zi({imagesUrls:I,onFirstImageLoad:f,onImageLoad:(E,A)=>{n==null||n(E,A,w),b[A]=E},onError:E=>{r==null||r({...E,orientation:w})},onAllImagesLoad:(E,A)=>{b.length=0,E.forEach((L,M)=>{L&&(b[M]=L)}),C.errorCount=A.errorCount,C.errors=A.errors.map(L=>({...L,orientation:w})),a[g?"x":"y"]=!0,y()},autoplayReverse:O.autoplayReverse})};u?v({cdnPath:e,config:i,orientation:Y.X,loadedImages:c,loadStats:p,onFirstImageLoad:s}):a.x=!0,x?v({cdnPath:t,config:o,orientation:Y.Y,loadedImages:h,loadStats:m,onFirstImageLoad:u?void 0:s}):a.y=!0,!u&&!x&&y()},Bi=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1052 156" aria-hidden="true">
  <path fill="currentColor" d="M409.9,145.6c-42.7-1.7-85.5-4.4-128.1-8.4c-21.3-2-42.6-4.3-63.8-7.1c-21.2-2.8-42.4-5.9-63.4-9.7c-21.1-3.8-42-8.2-62.7-13.7c-10.3-2.8-20.6-5.8-30.7-9.4c-10.1-3.5-20.1-7.6-29.5-12.7c-4.7-2.6-9.3-5.4-13.5-8.8c-2.1-1.7-4-3.6-5.8-5.6c-1.8-2-3.3-4.3-4.3-6.8c-1.1-2.5-1.6-5.3-1.4-8c0.2-2.7,1.1-5.4,2.4-7.7c2.7-4.8,6.7-8.5,11-11.7c8.6-6.4,18.4-10.9,28.3-15c9.9-4,20.1-7.3,30.4-10.3c-10.2,3.1-20.4,6.5-30.3,10.5c-9.8,4.1-19.6,8.7-28.1,15.1c-4.2,3.2-8.2,6.9-10.7,11.6c-1.2,2.3-2.1,4.8-2.3,7.5c-0.1,2.6,0.4,5.2,1.4,7.6c2.1,4.8,5.9,8.7,10,12.1c4.1,3.3,8.7,6.1,13.4,8.6c9.4,5,19.4,8.9,29.4,12.4c10.1,3.5,20.4,6.4,30.7,9.1c20.7,5.3,41.6,9.5,62.7,13.2c21,3.6,42.2,6.6,63.4,9.2c21.2,2.6,42.5,4.8,63.7,6.6c42.6,3.7,85.2,6,127.9,7.4L409.9,145.6z"/>
  <path fill="currentColor" d="M977.1,11.6c13.8,4.1,27.4,8.8,40.4,15.2c6.4,3.2,12.7,6.9,18.3,11.5c2.7,2.4,5.3,5,7.3,8c2,3,3.3,6.6,3.3,10.3c0,3.7-1.4,7.2-3.3,10.3c-2,3.1-4.5,5.7-7.3,8.1c-2.7,2.4-5.7,4.4-8.8,6.3c-1.6,0.9-3.1,1.9-4.7,2.7l-2.4,1.3l-2.4,1.2C1004.5,93,990.8,97.8,977,102c-6.9,2.1-13.8,4-20.8,5.8c-7,1.8-14,3.5-21,5c-14.1,3.1-28.2,5.9-42.4,8.3c-28.4,4.9-57,8.8-85.6,12c-57.3,6.4-114.8,10.2-172.4,12.2c-57.6,2-115.2,2.3-172.9,0.8l0.1-4c57.5,1.8,115.1,1.9,172.6,0.2c57.5-1.7,115-5.2,172.3-11.2c28.6-3.1,57.2-6.7,85.6-11.5c14.2-2.4,28.3-5,42.4-8.1c7-1.5,14-3.1,21-4.9c7-1.7,13.9-3.6,20.8-5.7c13.8-4.1,27.4-8.8,40.3-15.2l2.4-1.2l2.4-1.3c1.6-0.8,3.1-1.8,4.7-2.7c3-1.9,6-3.9,8.7-6.2c2.7-2.3,5.2-4.9,7.2-7.9c1.9-3,3.2-6.4,3.3-10c0-3.6-1.2-7-3.1-10c-1.9-3-4.4-5.6-7.1-8c-5.5-4.7-11.7-8.3-18.1-11.6C1004.5,20.6,990.8,15.8,977.1,11.6z"/>
  <g transform="translate(415, 136)">
    <path fill="currentColor" d="M18.1,11.2c-1.8,0-2.8-1.2-2.8-3V8c0.8-0.4,1.7-0.6,2.8-0.6c1.5,0,2.5,0.6,2.5,1.7C20.6,10.2,19.8,11.2,18.1,11.2L18.1,11.2z M18.3,5.7c-1.1,0-2,0.3-2.8,0.7c0.3-1.6,1.5-2.6,3.7-2.6c1.1,0,2.3,0.3,3.1,0.5V2.6c-0.8-0.3-1.9-0.5-3.1-0.5c-4.2,0-6.2,2.1-6.2,5.8c0,3.2,1.8,4.9,5.1,4.9c3.3,0,5-1.7,5-3.6C23,7,21.3,5.7,18.3,5.7L18.3,5.7z"/>
    <path fill="currentColor" d="M39.3,1.8c0.9,0,1.6,0.7,1.6,1.5c0,0.8-0.7,1.6-1.6,1.6c-0.8,0-1.6-0.7-1.6-1.6C37.8,2.5,38.5,1.8,39.3,1.8L39.3,1.8z M39.3,6.3c1.7,0,3.1-1.3,3.1-3c0-1.6-1.4-3-3.1-3c-1.7,0-3.1,1.3-3.1,3C36.2,5,37.6,6.3,39.3,6.3L39.3,6.3z"/>
    <path fill="currentColor" d="M30.3,3.8c2.1,0,2.9,1.4,2.9,3.6c0,2.2-0.8,3.6-2.9,3.6c-2.1,0-2.9-1.5-2.9-3.6C27.4,5.3,28.1,3.8,30.3,3.8L30.3,3.8z M30.2,12.8c3.9,0,5.2-2.6,5.2-5.4c0-2.8-1.3-5.3-5.2-5.3c-3.9,0-5.3,2.6-5.3,5.4C25,10.3,26.3,12.8,30.2,12.8L30.2,12.8z"/>
    <path fill="currentColor" d="M10.9,9.7c0-1.1-0.8-2-2.5-2.5c1.3-0.5,1.9-1.3,1.9-2.3c0-1.7-1.7-2.8-4.6-2.8c-1.5,0-2.7,0.3-3.6,0.8v1.7c0.9-0.4,2.3-0.7,3.4-0.7C7,3.9,8,4.4,8,5.1c0,0.8-0.7,1.3-2.4,1.3H4.3v1.6h1.3c2,0,2.9,0.8,2.9,1.6c0,0.8-1,1.5-2.8,1.5c-1.5,0-2.8-0.3-3.7-0.6v1.7c0.9,0.3,2.1,0.6,3.8,0.6C9.2,12.8,10.9,11.4,10.9,9.7"/>
  </g>
</svg>
`,Wi=e=>{const t=document.createElement("div");return t.innerHTML=Bi,t.style.bottom=`${e}%`,t.className="cloudimage-360-view-360-circle",t},zi=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <!-- Circular arrows -->
  <path d="M 75 50 A 25 25 0 1 1 50 25" stroke="currentColor" stroke-width="3"/>
  <path d="M 25 50 A 25 25 0 1 1 50 75" stroke="currentColor" stroke-width="3"/>
  <!-- Arrow heads -->
  <path d="M 50 25 L 56 31 M 50 25 L 56 19" stroke="currentColor" stroke-width="3"/>
  <path d="M 50 75 L 44 69 M 50 75 L 44 81" stroke="currentColor" stroke-width="3"/>
  <!-- 360 text -->
  <text x="50" y="54" text-anchor="middle" font-size="16" font-weight="600" fill="currentColor" stroke="none" font-family="system-ui, -apple-system, sans-serif">360Â°</text>
</svg>
`,Fi=e=>{const t=document.createElement("div");return t.className="cloudimage-initial-icon",t.setAttribute("aria-label","360 degree view - drag to rotate"),e?(t.style.backgroundImage=`url('${e}')`,t.style.backgroundPosition="50% 50%",t.style.backgroundSize="contain",t.style.backgroundRepeat="no-repeat"):t.innerHTML=zi,t},Ni=(e,t)=>{const{width:i,height:o}=t,s=document.createElement("canvas");return s.width=i,s.height=o,s.style.width="100%",s.style.height="auto",e.appendChild(s),s},Vi=()=>{const e=document.createElement("button");return e.className="cloudimage-360-button cloudimage-360-close-icon",e.setAttribute("aria-label","Close fullscreen"),e.setAttribute("type","button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',e},ji=()=>{const e=document.createElement("button");return e.className="cloudimage-360-button cloudimage-360-fullscreen-button",e.setAttribute("aria-label","View fullscreen"),e.setAttribute("type","button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>',e},we=e=>{const t=document.createElement("div");return t.className="cloudimage-360-icons-container",e.appendChild(t),t},$i=e=>{const t=document.createElement("div");return t.className="cloudimage-360-inner-box",t.setAttribute("role","img"),t.setAttribute("aria-label","360 degree product view. Use mouse drag or arrow keys to rotate."),e.appendChild(t),t},Gi=()=>{const e=document.createElement("button");return e.className="cloudimage-360-button cloudimage-360-magnifier-button",e.setAttribute("aria-label","Magnify image"),e.setAttribute("type","button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/><path d="M11 8v6"/><path d="M8 11h6"/></svg>',e},Ui=e=>{const t=document.createElement("div");t.className="cloudimage-initial-icon";const i=document.createElement("span");return i.className="percentage",i.innerText="0%",t.appendChild(i),e.appendChild(t),t},_i=e=>{const t=document.createElement("div");t.className="cloudimage-360-fullscreen-modal";const i=e.cloneNode();return i.style.width="100%",i.style.maxWidth="100%",i.style.height="100vh",i.style.maxHeight="100%",t.appendChild(i),window.document.body.appendChild(t),i},Gt=(e,t)=>{const i=e.querySelector(t);i&&i.parentNode.removeChild(i)},Ki=()=>{const e=document.createElement("div");return e.className="cloudimage-loading-spinner",e},Ji=()=>{const e=document.createElement("div");return e.className="cloudimage-360-transition-overlay",e},qi=e=>{const t=document.createElement("div");return t.className="cloudimage-360-hotspot-container",e.appendChild(t),t},Qi=e=>{const t=document.createElement("div");return t.className="cloudimage-360-sr-only",t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),e.appendChild(t),t},to=(e,t)=>{e&&(e.textContent="",setTimeout(()=>{e.textContent=t},50))},xe={drag:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2"/><path d="M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2"/><path d="M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8"/><path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"/></svg>',swipe:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="m18 16 4-4-4-4"/><path d="m6 8-4 4 4 4"/><path d="M8 12h8"/></svg>',click:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="m9 9 5 12 1.8-5.2L21 14Z"/><path d="M7.2 2.2 8 5.1"/><path d="m5.1 8-2.9-.8"/><path d="M14 4.1 12 6"/><path d="m6 12-1.9 2"/></svg>',pinch:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M6 6l4 4"/><path d="M18 6l-4 4"/><path d="M6 18l4-4"/><path d="M18 18l-4-4"/><circle cx="12" cy="12" r="2"/></svg>',keys:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m9 10 3 3 3-3"/></svg>',fullscreen:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>'},eo={drag:"Drag to rotate",swipe:"Swipe to rotate",click:"Click to zoom",pinch:"Pinch to zoom",keys:"Use arrow keys",fullscreen:"Click for fullscreen"},io=e=>{const t=document.createElement("div");return t.className="cloudimage-360-hint-item",t.innerHTML=`
    ${xe[e]}
    <span>${eo[e]}</span>
  `,t},Ie=(e,t=[])=>{if(!t||t.length===0)return null;const i=document.createElement("div");i.className="cloudimage-360-hints-overlay",i.setAttribute("role","tooltip"),i.setAttribute("aria-label","Interaction hints");const o=document.createElement("div");return o.className="cloudimage-360-hints-container",t.forEach(s=>{xe[s]&&o.appendChild(io(s))}),i.appendChild(o),e.appendChild(i),i},Ce=(e,t)=>t?["swipe"]:["drag","click"],ke=e=>{e&&e.classList.add("visible")},oo=e=>{e&&(e.classList.remove("visible"),e.classList.add("hiding"),setTimeout(()=>{e.classList.remove("hiding")},300))},so=e=>{if(!e||typeof e!="object")return null;const t=Object.keys(e).map(o=>parseInt(o,10)).filter(o=>!isNaN(o)).sort((o,s)=>o-s);if(t.length===0)return null;const i=Math.floor(t.length/2);return t[i]},no=e=>{const t=[];return!e||!Array.isArray(e)||e.forEach((i,o)=>{const s=so(i.positions);s!==null&&t.push({id:i.id||`hotspot-${o}`,frame:s,label:i.label||null})}),t},ro=400,ao=(e,t,i,o)=>{const s=document.createElement("button");s.className="cloudimage-360-hotspot-timeline-dot",s.setAttribute("type","button"),s.setAttribute("aria-label",o||`Go to hotspot at frame ${t+1}`),s.setAttribute("data-frame",t.toString()),s.setAttribute("data-hotspot-id",e);const n=i>1?t/(i-1)*100:0;if(s.style.left=`${n}%`,o){const l=document.createElement("span");l.className="cloudimage-360-hotspot-timeline-tooltip",l.textContent=o,s.appendChild(l);let r=null;s.addEventListener("mouseenter",()=>{r=setTimeout(()=>{l.classList.add("visible")},ro)}),s.addEventListener("mouseleave",()=>{r&&(clearTimeout(r),r=null),l.classList.remove("visible")}),s.addEventListener("click",()=>{r&&(clearTimeout(r),r=null),l.classList.remove("visible")})}return s},lo=(e,t,i)=>{const o=no(i);if(o.length===0)return null;const s=document.createElement("div");s.className="cloudimage-360-hotspot-timeline",s.setAttribute("role","navigation"),s.setAttribute("aria-label","Hotspot timeline navigation");const n=document.createElement("div");n.className="cloudimage-360-hotspot-timeline-track";const l=document.createElement("div");return l.className="cloudimage-360-hotspot-timeline-indicator",o.forEach(({id:r,frame:a,label:c})=>{const h=ao(r,a,t,c);n.appendChild(h)}),n.appendChild(l),s.appendChild(n),e.appendChild(s),{element:s,indicator:l,hotspotFrames:o}},co=(e,t,i)=>{if(!e)return;const o=i>1?t/(i-1)*100:0;e.style.left=`${o}%`},ho=e=>{e&&e.classList.add("visible")},po=e=>{e&&e.classList.remove("visible")},Ut=(e,t=[])=>{if(!e)return t;try{return JSON.parse(e)}catch(i){return console.warn("CloudImage 360: Failed to parse JSON:",i.message),t}},uo=(e,t)=>{const[i,o]=e.split("?");if(!o)return e;const s=new RegExp(`^${t}=|&${t}=`),n=o.split("&").filter(l=>!s.test(l)).join("&");return n?`${i}?${n}`:i},fo=e=>{const t=uo(e,"width"),i=t.includes("?")?"&":"?";return`${t}${i}width=${150*devicePixelRatio}`},mo=e=>{const t={root:null,rootMargin:"0px",threshold:.1},i=s=>{const n=s.getAttribute("data-src");n&&(s.src=n)};new IntersectionObserver((s,n)=>{s.forEach(l=>{l.isIntersecting&&(i(l.target),n.unobserve(l.target))})},t).observe(e)},vo=(e,t)=>{const i=be(1,t);return e.replace("{index}",i)},go=(e,t)=>{const[i]=e,o=/(https?):\/\//i.test(i);return bt({...t,folder:o?"":t.folder,filename:i})},bo=(e,t)=>{const{imageList:i,indexZeroBase:o}=t;if(i.length){const s=Ut(i,null);if(s)return go(s,t)}return vo(e,o)},Oe=(e,t,i)=>{const o=new Image;return o.setAttribute(t?"data-src":"src",e),o.className=i,o.style.cssText=`
    position: ${t?"absolute":"static"};
    width: 100%;
    inset: 0;
    height: 100%;
    object-fit: contain;
    object-position: center;
    filter: blur(10px);
  `,o},Ee=(e,t,i)=>{const{innerBox:o,imageList:s,lazyload:n}=t||{},[l]=s,r=l||bo(e,t),a=fo(r),c=Oe(a,n,"cloudimage-lazy"),h=Oe(a,!1,"cloudimage-360-placeholder"),p=m=>{Gt(o,".cloudimage-lazy"),i&&i({event:m,width:c.width,height:c.height,naturalWidth:c.naturalWidth,naturalHeight:c.naturalHeight,src:a})};c.onload=p,o.appendChild(c),o.appendChild(h),mo(c)},yo=(e,t,i)=>{const o=new Image;o.src=e,o.onload=s=>{t&&t({event:s,width:o.width,height:o.height,naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight,src:e})},o.onerror=s=>{const n=new Error(`Failed to load image: ${e}`);n.url=e,n.event=s,i?i(n):console.error(n.message)}},wo=(e,t)=>{const i=t.getBoundingClientRect(),o=e.touches?e.touches[0].clientX:e.clientX,s=e.touches?e.touches[0].clientY:e.clientY;return{x:o-i.left,y:s-i.top}},_t=(e,t,i)=>{const{container:o,w:s,h:n,zoom:l,bw:r,offsetX:a,offsetY:c}=t,h=wo(e,o);let p=h.x,m=h.y;p=Math.max(s/l,Math.min(p,o.offsetWidth-s/l)),m=Math.max(n/l,Math.min(m,o.offsetHeight-n/l)),i.style.left=`${p-s}px`,i.style.top=`${m-n}px`;const u=(p-a)*l-s+r,x=(m-c)*l-n+r;i.style.backgroundPosition=`-${u}px -${x}px`},xo=(e,t,i,o,s,n)=>{const{x:l=0,y:r=0}=i||{},a=(t.offsetWidth-l*2)*n,c=(t.offsetHeight-r*2)*n;if(!s)return;s.setAttribute("class","cloudimage-360-img-magnifier-glass"),t.prepend(s),s.style.backgroundImage=`url('${o.src}')`,s.style.backgroundSize=`${a}px ${c}px`;const h=3,p=s.offsetWidth/2,m=s.offsetHeight/2,u={container:t,w:p,h:m,zoom:n,bw:h,offsetX:l,offsetY:r};_t(e,u,s);const x=v=>{_t(v,u,s)},y=v=>{v.preventDefault(),_t(v,u,s)};s.addEventListener("mousemove",x),t.addEventListener("mousemove",x),t.addEventListener("touchmove",y)},Io=(e,t,i)=>{const{clientX:o,clientY:s}=e,n=t.getBoundingClientRect(),l=t.width/(n.width*i),r=t.height/(n.height*i),a=(o-n.left)*l,c=(s-n.top)*r;return{offsetX:a,offsetY:c}},Co=(e,t,i)=>{const o=e/i,s=t/i;return{zoomedWidth:o,zoomedHeight:s}},ko=({pointerX:e,pointerY:t,imageData:i,zoomedWidth:o,zoomedHeight:s,drawWidth:n,drawHeight:l})=>{const{naturalWidth:r,naturalHeight:a}=i;let c=e/n*r-o/2,h=t/l*a-s/2;const p=Math.max(0,r-o),m=Math.max(0,a-s);return c=Math.max(0,Math.min(c,p)),h=Math.max(0,Math.min(h,m)),{zoomOffsetX:c,zoomOffsetY:h}},Ae=(e,{bottom:t,top:i})=>{e?t():i()},Se=(e,{left:t,right:i})=>{e?t():i()},Oo=({autoplayBehavior:e,spinY:t,reversed:i,loopTriggers:o})=>{switch(e){case R.SPIN_XY:case R.SPIN_YX:t?Ae(i,o):Se(i,o);break;case R.SPIN_Y:Ae(i,o);break;case R.SPIN_X:default:Se(i,o)}},Eo=({autoplayBehavior:e,activeImageX:t,activeImageY:i,amountX:o,amountY:s,autoplayReverse:n})=>{const l=(r,a)=>{const c=a-1;return n?r===0:r===c};switch(e){case R.SPIN_XY:case R.SPIN_Y:return l(i,s);case R.SPIN_X:case R.SPIN_YX:default:return l(t,o)}},Ao=({autoplayBehavior:e,activeImageX:t,activeImageY:i,amountX:o,amountY:s,autoplayReverse:n,spinDirection:l})=>{const r=t===(n?0:o-1),a=i===(n?0:s-1);return e===R.SPIN_XY||e===R.SPIN_YX?l==="x"&&r||l==="y"&&a:!1},So=(e,t,i)=>{if(!i)return"x";if(!t)return"y";switch(e){case R.SPIN_XY:return"x";case R.SPIN_YX:return"y";case R.SPIN_Y:return"y";case R.SPIN_X:default:return"x"}},Lo=e=>e==="x"?"y":"x",Le=(e,t)=>{const i=[...xi];return t?[...i,...Ii].includes(e):i.includes(e)},Te=({deltaX:e,deltaY:t,reversed:i,allowSpinX:o,allowSpinY:s,threshold:n=0})=>{const l=o&&!s||s&&!o?0:n,r=Math.abs(e),a=Math.abs(t);return o&&r-l>a?i?e>0?"left":"right":e>0?"right":"left":s&&a-l>r?i?t>0?"up":"down":t>0?"down":"up":null},To=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,Yo=(e,t=150)=>{let i;return function(...o){clearTimeout(i),i=setTimeout(()=>{e.apply(this,o)},t)}},Ye="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IHY9KHQsYSxlKT0+e2NvbnN0IHM9dC9lLG49YS9lO3JldHVybnt6b29tZWRXaWR0aDpzLHpvb21lZEhlaWdodDpufX0sej0oe3BvaW50ZXJYOnQscG9pbnRlclk6YSxpbWFnZURhdGE6ZSx6b29tZWRXaWR0aDpzLHpvb21lZEhlaWdodDpuLGRyYXdXaWR0aDppLGRyYXdIZWlnaHQ6Y30pPT57Y29uc3R7bmF0dXJhbFdpZHRoOmcsbmF0dXJhbEhlaWdodDp1fT1lO2xldCBmPXQvaSpnLXMvMixtPWEvYyp1LW4vMjtjb25zdCB4PU1hdGgubWF4KDAsZy1zKSxPPU1hdGgubWF4KDAsdS1uKTtyZXR1cm4gZj1NYXRoLm1heCgwLE1hdGgubWluKGYseCkpLG09TWF0aC5tYXgoMCxNYXRoLm1pbihtLE8pKSx7em9vbU9mZnNldFg6Zix6b29tT2Zmc2V0WTptfX07bGV0IG8saCxyLGQsbCx3O3NlbGYub25tZXNzYWdlPWFzeW5jIHQ9Pntjb25zdHthY3Rpb246YSxvZmZzY3JlZW46ZSxkZXZpY2VQaXhlbFJhdGlvOnMsaW1hZ2VEYXRhOm4sem9vbVNjYWxlOmkscG9pbnRlclg6Yyxwb2ludGVyWTpnLGltYWdlQXNwZWN0UmF0aW86dSxjb250YWluZXJXaWR0aDpmLGNvbnRhaW5lckhlaWdodDptfT10LmRhdGE7c3dpdGNoKGEpe2Nhc2UiaW5pdENhbnZhcyI6QyhlLHMpO2JyZWFrO2Nhc2UiYWRhcHRDYW52YXNTaXplIjpwKHUsZixtKTticmVhaztjYXNlImRyYXdJbWFnZU9uQ2FudmFzIjpJKG4saSxjLGcpO2JyZWFrfX07Y29uc3QgQz0odCxhKT0+e289dCxoPW8uZ2V0Q29udGV4dCgiMmQiKSxyPWF9LHA9KHQsYSxlKT0+e2NvbnN0IHM9YS9lO3c9dD5zLG8ud2lkdGg9YSpyLG8uaGVpZ2h0PWUqcixoLnNjYWxlKHIsciksdz8oZD1hLGw9YS90KToobD1lLGQ9ZSp0KSxoLmltYWdlU21vb3RoaW5nRW5hYmxlZD0hMCxoLmltYWdlU21vb3RoaW5nUXVhbGl0eT0iaGlnaCJ9LEk9KHQ9e30sYT0xLGU9MCxzPTApPT57Y29uc3R7Yml0bWFwSW1hZ2U6bn09dDtpZighb3x8IW4pcmV0dXJuO2xldCBpLGM7aWYodz8oaT0wLGM9KG8uaGVpZ2h0L3ItbCkvMik6KGk9KG8ud2lkdGgvci1kKS8yLGM9MCksaC5jbGVhclJlY3QoMCwwLG8ud2lkdGgsby5oZWlnaHQpLGEhPT0xKXtjb25zdHtuYXR1cmFsV2lkdGg6ZyxuYXR1cmFsSGVpZ2h0OnV9PXQse3pvb21lZFdpZHRoOmYsem9vbWVkSGVpZ2h0Om19PXYoZyx1LGEpLHt6b29tT2Zmc2V0WDp4LHpvb21PZmZzZXRZOk99PXooe3BvaW50ZXJYOmUscG9pbnRlclk6cyxpbWFnZURhdGE6dCx6b29tZWRXaWR0aDpmLHpvb21lZEhlaWdodDptLGRyYXdXaWR0aDpkLGRyYXdIZWlnaHQ6bH0pO2guZHJhd0ltYWdlKG4seCxPLGYsbSxpLGMsZCxsKX1lbHNlIGguZHJhd0ltYWdlKG4saSxjLGQsbCl9fSkoKTsK",Po=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),Pe=typeof self<"u"&&self.Blob&&new Blob([Po(Ye)],{type:"text/javascript;charset=utf-8"});function Xo(e){let t;try{if(t=Pe&&(self.URL||self.webkitURL).createObjectURL(Pe),!t)throw"";const i=new Worker(t,{name:e==null?void 0:e.name});return i.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),i}catch{return new Worker("data:text/javascript;base64,"+Ye,{name:e==null?void 0:e.name})}finally{t&&(self.URL||self.webkitURL).revokeObjectURL(t)}}class Ro{constructor(){this.canvas=null,this.ctx=null,this.dpr=1,this.drawWidth=0,this.drawHeight=0,this.wideImage=!1}postMessage(t){const{action:i,offscreen:o,devicePixelRatio:s,imageData:n,zoomScale:l,pointerX:r,pointerY:a,imageAspectRatio:c,containerWidth:h,containerHeight:p}=t;switch(i){case"initCanvas":this.initCanvas(o,s);break;case"adaptCanvasSize":this.adaptCanvasSize(c,h,p);break;case"drawImageOnCanvas":this.drawImageOnCanvas(n,l,r,a);break}}terminate(){var t,i;this.ctx&&this.ctx.clearRect(0,0,((t=this.canvas)==null?void 0:t.width)||0,((i=this.canvas)==null?void 0:i.height)||0),this.canvas=null,this.ctx=null}initCanvas(t,i){this.canvas=t,this.ctx=t.getContext("2d"),this.dpr=i}adaptCanvasSize(t,i,o){if(!this.canvas||!this.ctx)return;const s=i/o;this.wideImage=t>s,this.canvas.width=i*this.dpr,this.canvas.height=o*this.dpr,this.ctx.scale(this.dpr,this.dpr),this.wideImage?(this.drawWidth=i,this.drawHeight=i/t):(this.drawHeight=o,this.drawWidth=o*t),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high"}drawImageOnCanvas(t={},i=1,o=0,s=0){const{bitmapImage:n}=t;if(!this.canvas||!this.ctx||!n)return;let l,r;if(this.wideImage?(l=0,r=(this.canvas.height/this.dpr-this.drawHeight)/2):(l=(this.canvas.width/this.dpr-this.drawWidth)/2,r=0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),i!==1){const{naturalWidth:a,naturalHeight:c}=t,{zoomedWidth:h,zoomedHeight:p}=Co(a,c,i),{zoomOffsetX:m,zoomOffsetY:u}=ko({pointerX:o,pointerY:s,imageData:t,zoomedWidth:h,zoomedHeight:p,drawWidth:this.drawWidth,drawHeight:this.drawHeight});this.ctx.drawImage(n,m,u,h,p,l,r,this.drawWidth,this.drawHeight)}else this.ctx.drawImage(n,l,r,this.drawWidth,this.drawHeight)}}const Mo=new Set(["p","span","div","br","hr","strong","em","b","i","u","s","h1","h2","h3","h4","h5","h6","ul","ol","li","a","img","button","table","thead","tbody","tr","th","td","blockquote","pre","code","label","input","select","option","textarea","svg","path","circle","rect","line","polyline","polygon","ellipse","g","text","tspan","defs","use","symbol","clippath","mask","lineargradient","radialgradient","stop"]),Xe={a:["href","title","target","rel"],img:["src","alt","title","width","height"],button:["type","disabled","name","value"],input:["type","name","value","placeholder","disabled","readonly","checked","min","max","step"],select:["name","disabled","multiple"],option:["value","disabled","selected"],textarea:["name","placeholder","disabled","readonly","rows","cols"],label:["for"],svg:["viewbox","width","height","fill","stroke","xmlns","preserveaspectratio"],path:["d","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin","transform"],circle:["cx","cy","r","fill","stroke","stroke-width"],rect:["x","y","width","height","rx","ry","fill","stroke","stroke-width"],line:["x1","y1","x2","y2","stroke","stroke-width"],polyline:["points","fill","stroke","stroke-width"],polygon:["points","fill","stroke","stroke-width"],ellipse:["cx","cy","rx","ry","fill","stroke","stroke-width"],g:["transform","fill","stroke"],text:["x","y","dx","dy","text-anchor","fill","font-size","font-family","font-weight"],tspan:["x","y","dx","dy"],use:["href","xlink:href","x","y","width","height"],lineargradient:["id","x1","y1","x2","y2","gradientunits"],radialgradient:["id","cx","cy","r","fx","fy","gradientunits"],stop:["offset","stop-color","stop-opacity"],clippath:["id"],mask:["id"],"*":["class","id","style"]},Ho=[/javascript:/gi,/vbscript:/gi,/data:/gi,/on\w+\s*=/gi],Do=e=>{if(typeof e!="string")return"";const t=document.createElement("template");t.innerHTML=e;const i=o=>{if(Array.from(o.childNodes).forEach(i),o.nodeType===Node.ELEMENT_NODE){const n=o.tagName.toLowerCase();if(!Mo.has(n)){if(n==="script"||n==="style"){o.remove();return}const a=document.createTextNode(o.textContent);o.parentNode.replaceChild(a,o);return}const l=[...Xe[n]||[],...Xe["*"]||[]];if(Array.from(o.attributes).forEach(a=>{const c=a.name.toLowerCase();if(c.startsWith("on")){o.removeAttribute(a.name);return}if(!l.includes(c)){o.removeAttribute(a.name);return}let h=a.value;Ho.forEach(p=>{p.test(h)&&o.removeAttribute(a.name)})}),n==="a"){const a=o.getAttribute("href");a&&(/^(https?:|mailto:|tel:|#|\/)/i.test(a.trim())||o.removeAttribute("href")),o.getAttribute("target")==="_blank"&&o.setAttribute("rel","noopener noreferrer")}if(n==="img"){const a=o.getAttribute("src");a&&(/^(https?:|\/|data:image\/)/i.test(a.trim())||o.removeAttribute("src"))}}};return i(t.content),t.innerHTML},Zo=e=>e==="x"?Y.X:Y.Y,Bo=(e,t,i)=>e.filter(o=>Zo(o.orientation)===i&&t in o.positions),Wo=(e,t)=>{const i=document.createElement("button");return i.id=e,i.className="cloudimage-360-hotspot",i.dataset.hotspotId=e,i.setAttribute("type","button"),i.setAttribute("aria-label",t||`Hotspot ${e}`),i.setAttribute("aria-haspopup","true"),i.setAttribute("aria-expanded","false"),i},zo=e=>{const t=Object.entries(e).sort(([n],[l])=>Number(n)-Number(l));let i=null,o=null;const s={};for(const[n,l]of t)if(!l)s[n]={x:i,y:o};else{const{x:r,y:a}=l;r!=null&&(i=r),a!=null&&(o=a),s[n]={x:r||i,y:a||o}}return s},Fo=e=>[{name:"offset",options:{offset:[0,10]}},{name:"preventOverflow",options:{boundary:e}}],No=(e,t)=>{const i=document.createElement("div");return i.className="cloudimage-360-popper",i.id=`cloudimage-360-popper-${t}`,i.dataset.popperId=t,i.setAttribute("role","tooltip"),i.setAttribute("aria-hidden","false"),typeof e=="string"&&/<\/?[a-z][\s\S]*>/i.test(e)?i.innerHTML=Do(e):i.textContent=e,document.body.appendChild(i),i},Vo=e=>{const t=[...e];return t.forEach((i,o)=>{const s={...zo(i.positions)};t[o].initialPositions=s,t[o].positions=s}),t},jo=({newWidth:e,newHeight:t,initialContainerSize:i,imageAspectRatio:o,hotspotsConfig:s})=>{const[n,l]=i;let r=e,a=t,c=0,h=0;const p=e/t;o>p?(a=e/o,h=(t-a)/2):(r=t*o,c=(e-r)/2);const u=r/n,x=a/l;return s.map(y=>{const v={};return Object.entries(y.initialPositions).forEach(([k,O])=>{v[k]={x:O.x*u+c,y:O.y*x+h}}),{...y,positions:v}})};var H="top",z="bottom",F="right",D="left",Kt="auto",yt=[H,z,F,D],lt="start",wt="end",$o="clippingParents",Re="viewport",xt="popper",Go="reference",Me=yt.reduce(function(e,t){return e.concat([t+"-"+lt,t+"-"+wt])},[]),He=[].concat(yt,[Kt]).reduce(function(e,t){return e.concat([t,t+"-"+lt,t+"-"+wt])},[]),Uo="beforeRead",_o="read",Ko="afterRead",Jo="beforeMain",qo="main",Qo="afterMain",ts="beforeWrite",es="write",is="afterWrite",os=[Uo,_o,Ko,Jo,qo,Qo,ts,es,is];function V(e){return e?(e.nodeName||"").toLowerCase():null}function Z(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function it(e){var t=Z(e).Element;return e instanceof t||e instanceof Element}function N(e){var t=Z(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function Jt(e){if(typeof ShadowRoot>"u")return!1;var t=Z(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function ss(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var o=t.styles[i]||{},s=t.attributes[i]||{},n=t.elements[i];!N(n)||!V(n)||(Object.assign(n.style,o),Object.keys(s).forEach(function(l){var r=s[l];r===!1?n.removeAttribute(l):n.setAttribute(l,r===!0?"":r)}))})}function ns(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(o){var s=t.elements[o],n=t.attributes[o]||{},l=Object.keys(t.styles.hasOwnProperty(o)?t.styles[o]:i[o]),r=l.reduce(function(a,c){return a[c]="",a},{});!N(s)||!V(s)||(Object.assign(s.style,r),Object.keys(n).forEach(function(a){s.removeAttribute(a)}))})}}const rs={name:"applyStyles",enabled:!0,phase:"write",fn:ss,effect:ns,requires:["computeStyles"]};function j(e){return e.split("-")[0]}var ot=Math.max,Ht=Math.min,ct=Math.round;function qt(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function De(){return!/^((?!chrome|android).)*safari/i.test(qt())}function ht(e,t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var o=e.getBoundingClientRect(),s=1,n=1;t&&N(e)&&(s=e.offsetWidth>0&&ct(o.width)/e.offsetWidth||1,n=e.offsetHeight>0&&ct(o.height)/e.offsetHeight||1);var l=it(e)?Z(e):window,r=l.visualViewport,a=!De()&&i,c=(o.left+(a&&r?r.offsetLeft:0))/s,h=(o.top+(a&&r?r.offsetTop:0))/n,p=o.width/s,m=o.height/n;return{width:p,height:m,top:h,right:c+p,bottom:h+m,left:c,x:c,y:h}}function Qt(e){var t=ht(e),i=e.offsetWidth,o=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-o)<=1&&(o=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:o}}function Ze(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&Jt(i)){var o=t;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function U(e){return Z(e).getComputedStyle(e)}function as(e){return["table","td","th"].indexOf(V(e))>=0}function tt(e){return((it(e)?e.ownerDocument:e.document)||window.document).documentElement}function Dt(e){return V(e)==="html"?e:e.assignedSlot||e.parentNode||(Jt(e)?e.host:null)||tt(e)}function Be(e){return!N(e)||U(e).position==="fixed"?null:e.offsetParent}function ls(e){var t=/firefox/i.test(qt()),i=/Trident/i.test(qt());if(i&&N(e)){var o=U(e);if(o.position==="fixed")return null}var s=Dt(e);for(Jt(s)&&(s=s.host);N(s)&&["html","body"].indexOf(V(s))<0;){var n=U(s);if(n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].indexOf(n.willChange)!==-1||t&&n.willChange==="filter"||t&&n.filter&&n.filter!=="none")return s;s=s.parentNode}return null}function It(e){for(var t=Z(e),i=Be(e);i&&as(i)&&U(i).position==="static";)i=Be(i);return i&&(V(i)==="html"||V(i)==="body"&&U(i).position==="static")?t:i||ls(e)||t}function te(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Ct(e,t,i){return ot(e,Ht(t,i))}function cs(e,t,i){var o=Ct(e,t,i);return o>i?i:o}function We(){return{top:0,right:0,bottom:0,left:0}}function ze(e){return Object.assign({},We(),e)}function Fe(e,t){return t.reduce(function(i,o){return i[o]=e,i},{})}var hs=function(t,i){return t=typeof t=="function"?t(Object.assign({},i.rects,{placement:i.placement})):t,ze(typeof t!="number"?t:Fe(t,yt))};function ds(e){var t,i=e.state,o=e.name,s=e.options,n=i.elements.arrow,l=i.modifiersData.popperOffsets,r=j(i.placement),a=te(r),c=[D,F].indexOf(r)>=0,h=c?"height":"width";if(!(!n||!l)){var p=hs(s.padding,i),m=Qt(n),u=a==="y"?H:D,x=a==="y"?z:F,y=i.rects.reference[h]+i.rects.reference[a]-l[a]-i.rects.popper[h],v=l[a]-i.rects.reference[a],k=It(n),O=k?a==="y"?k.clientHeight||0:k.clientWidth||0:0,w=y/2-v/2,b=p[u],C=O-m[h]-p[x],f=O/2-m[h]/2+w,g=Ct(b,f,C),I=a;i.modifiersData[o]=(t={},t[I]=g,t.centerOffset=g-f,t)}}function ps(e){var t=e.state,i=e.options,o=i.element,s=o===void 0?"[data-popper-arrow]":o;s!=null&&(typeof s=="string"&&(s=t.elements.popper.querySelector(s),!s)||Ze(t.elements.popper,s)&&(t.elements.arrow=s))}const us={name:"arrow",enabled:!0,phase:"main",fn:ds,effect:ps,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function dt(e){return e.split("-")[1]}var fs={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ms(e,t){var i=e.x,o=e.y,s=t.devicePixelRatio||1;return{x:ct(i*s)/s||0,y:ct(o*s)/s||0}}function Ne(e){var t,i=e.popper,o=e.popperRect,s=e.placement,n=e.variation,l=e.offsets,r=e.position,a=e.gpuAcceleration,c=e.adaptive,h=e.roundOffsets,p=e.isFixed,m=l.x,u=m===void 0?0:m,x=l.y,y=x===void 0?0:x,v=typeof h=="function"?h({x:u,y}):{x:u,y};u=v.x,y=v.y;var k=l.hasOwnProperty("x"),O=l.hasOwnProperty("y"),w=D,b=H,C=window;if(c){var f=It(i),g="clientHeight",I="clientWidth";if(f===Z(i)&&(f=tt(i),U(f).position!=="static"&&r==="absolute"&&(g="scrollHeight",I="scrollWidth")),f=f,s===H||(s===D||s===F)&&n===wt){b=z;var E=p&&f===C&&C.visualViewport?C.visualViewport.height:f[g];y-=E-o.height,y*=a?1:-1}if(s===D||(s===H||s===z)&&n===wt){w=F;var A=p&&f===C&&C.visualViewport?C.visualViewport.width:f[I];u-=A-o.width,u*=a?1:-1}}var L=Object.assign({position:r},c&&fs),M=h===!0?ms({x:u,y},Z(i)):{x:u,y};if(u=M.x,y=M.y,a){var T;return Object.assign({},L,(T={},T[b]=O?"0":"",T[w]=k?"0":"",T.transform=(C.devicePixelRatio||1)<=1?"translate("+u+"px, "+y+"px)":"translate3d("+u+"px, "+y+"px, 0)",T))}return Object.assign({},L,(t={},t[b]=O?y+"px":"",t[w]=k?u+"px":"",t.transform="",t))}function vs(e){var t=e.state,i=e.options,o=i.gpuAcceleration,s=o===void 0?!0:o,n=i.adaptive,l=n===void 0?!0:n,r=i.roundOffsets,a=r===void 0?!0:r,c={placement:j(t.placement),variation:dt(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Ne(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:l,roundOffsets:a})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Ne(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const gs={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:vs,data:{}};var Zt={passive:!0};function bs(e){var t=e.state,i=e.instance,o=e.options,s=o.scroll,n=s===void 0?!0:s,l=o.resize,r=l===void 0?!0:l,a=Z(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return n&&c.forEach(function(h){h.addEventListener("scroll",i.update,Zt)}),r&&a.addEventListener("resize",i.update,Zt),function(){n&&c.forEach(function(h){h.removeEventListener("scroll",i.update,Zt)}),r&&a.removeEventListener("resize",i.update,Zt)}}const ys={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:bs,data:{}};var ws={left:"right",right:"left",bottom:"top",top:"bottom"};function Bt(e){return e.replace(/left|right|bottom|top/g,function(t){return ws[t]})}var xs={start:"end",end:"start"};function Ve(e){return e.replace(/start|end/g,function(t){return xs[t]})}function ee(e){var t=Z(e),i=t.pageXOffset,o=t.pageYOffset;return{scrollLeft:i,scrollTop:o}}function ie(e){return ht(tt(e)).left+ee(e).scrollLeft}function Is(e,t){var i=Z(e),o=tt(e),s=i.visualViewport,n=o.clientWidth,l=o.clientHeight,r=0,a=0;if(s){n=s.width,l=s.height;var c=De();(c||!c&&t==="fixed")&&(r=s.offsetLeft,a=s.offsetTop)}return{width:n,height:l,x:r+ie(e),y:a}}function Cs(e){var t,i=tt(e),o=ee(e),s=(t=e.ownerDocument)==null?void 0:t.body,n=ot(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),l=ot(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),r=-o.scrollLeft+ie(e),a=-o.scrollTop;return U(s||i).direction==="rtl"&&(r+=ot(i.clientWidth,s?s.clientWidth:0)-n),{width:n,height:l,x:r,y:a}}function oe(e){var t=U(e),i=t.overflow,o=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+o)}function je(e){return["html","body","#document"].indexOf(V(e))>=0?e.ownerDocument.body:N(e)&&oe(e)?e:je(Dt(e))}function kt(e,t){var i;t===void 0&&(t=[]);var o=je(e),s=o===((i=e.ownerDocument)==null?void 0:i.body),n=Z(o),l=s?[n].concat(n.visualViewport||[],oe(o)?o:[]):o,r=t.concat(l);return s?r:r.concat(kt(Dt(l)))}function se(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ks(e,t){var i=ht(e,!1,t==="fixed");return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}function $e(e,t,i){return t===Re?se(Is(e,i)):it(t)?ks(t,i):se(Cs(tt(e)))}function Os(e){var t=kt(Dt(e)),i=["absolute","fixed"].indexOf(U(e).position)>=0,o=i&&N(e)?It(e):e;return it(o)?t.filter(function(s){return it(s)&&Ze(s,o)&&V(s)!=="body"}):[]}function Es(e,t,i,o){var s=t==="clippingParents"?Os(e):[].concat(t),n=[].concat(s,[i]),l=n[0],r=n.reduce(function(a,c){var h=$e(e,c,o);return a.top=ot(h.top,a.top),a.right=Ht(h.right,a.right),a.bottom=Ht(h.bottom,a.bottom),a.left=ot(h.left,a.left),a},$e(e,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function Ge(e){var t=e.reference,i=e.element,o=e.placement,s=o?j(o):null,n=o?dt(o):null,l=t.x+t.width/2-i.width/2,r=t.y+t.height/2-i.height/2,a;switch(s){case H:a={x:l,y:t.y-i.height};break;case z:a={x:l,y:t.y+t.height};break;case F:a={x:t.x+t.width,y:r};break;case D:a={x:t.x-i.width,y:r};break;default:a={x:t.x,y:t.y}}var c=s?te(s):null;if(c!=null){var h=c==="y"?"height":"width";switch(n){case lt:a[c]=a[c]-(t[h]/2-i[h]/2);break;case wt:a[c]=a[c]+(t[h]/2-i[h]/2);break}}return a}function Ot(e,t){t===void 0&&(t={});var i=t,o=i.placement,s=o===void 0?e.placement:o,n=i.strategy,l=n===void 0?e.strategy:n,r=i.boundary,a=r===void 0?$o:r,c=i.rootBoundary,h=c===void 0?Re:c,p=i.elementContext,m=p===void 0?xt:p,u=i.altBoundary,x=u===void 0?!1:u,y=i.padding,v=y===void 0?0:y,k=ze(typeof v!="number"?v:Fe(v,yt)),O=m===xt?Go:xt,w=e.rects.popper,b=e.elements[x?O:m],C=Es(it(b)?b:b.contextElement||tt(e.elements.popper),a,h,l),f=ht(e.elements.reference),g=Ge({reference:f,element:w,placement:s}),I=se(Object.assign({},w,g)),E=m===xt?I:f,A={top:C.top-E.top+k.top,bottom:E.bottom-C.bottom+k.bottom,left:C.left-E.left+k.left,right:E.right-C.right+k.right},L=e.modifiersData.offset;if(m===xt&&L){var M=L[s];Object.keys(A).forEach(function(T){var _=[F,z].indexOf(T)>=0?1:-1,K=[H,z].indexOf(T)>=0?"y":"x";A[T]+=M[K]*_})}return A}function As(e,t){t===void 0&&(t={});var i=t,o=i.placement,s=i.boundary,n=i.rootBoundary,l=i.padding,r=i.flipVariations,a=i.allowedAutoPlacements,c=a===void 0?He:a,h=dt(o),p=h?r?Me:Me.filter(function(x){return dt(x)===h}):yt,m=p.filter(function(x){return c.indexOf(x)>=0});m.length===0&&(m=p);var u=m.reduce(function(x,y){return x[y]=Ot(e,{placement:y,boundary:s,rootBoundary:n,padding:l})[j(y)],x},{});return Object.keys(u).sort(function(x,y){return u[x]-u[y]})}function Ss(e){if(j(e)===Kt)return[];var t=Bt(e);return[Ve(e),t,Ve(t)]}function Ls(e){var t=e.state,i=e.options,o=e.name;if(!t.modifiersData[o]._skip){for(var s=i.mainAxis,n=s===void 0?!0:s,l=i.altAxis,r=l===void 0?!0:l,a=i.fallbackPlacements,c=i.padding,h=i.boundary,p=i.rootBoundary,m=i.altBoundary,u=i.flipVariations,x=u===void 0?!0:u,y=i.allowedAutoPlacements,v=t.options.placement,k=j(v),O=k===v,w=a||(O||!x?[Bt(v)]:Ss(v)),b=[v].concat(w).reduce(function(et,$){return et.concat(j($)===Kt?As(t,{placement:$,boundary:h,rootBoundary:p,padding:c,flipVariations:x,allowedAutoPlacements:y}):$)},[]),C=t.rects.reference,f=t.rects.popper,g=new Map,I=!0,E=b[0],A=0;A<b.length;A++){var L=b[A],M=j(L),T=dt(L)===lt,_=[H,z].indexOf(M)>=0,K=_?"width":"height",X=Ot(t,{placement:L,boundary:h,rootBoundary:p,altBoundary:m,padding:c}),B=_?T?F:D:T?z:H;C[K]>f[K]&&(B=Bt(B));var pt=Bt(B),J=[];if(n&&J.push(X[M]<=0),r&&J.push(X[B]<=0,X[pt]<=0),J.every(function(et){return et})){E=L,I=!1;break}g.set(L,J)}if(I)for(var ut=x?3:1,Et=function($){var nt=b.find(function(mt){var G=g.get(mt);if(G)return G.slice(0,$).every(function(At){return At})});if(nt)return E=nt,"break"},st=ut;st>0;st--){var ft=Et(st);if(ft==="break")break}t.placement!==E&&(t.modifiersData[o]._skip=!0,t.placement=E,t.reset=!0)}}const Ts={name:"flip",enabled:!0,phase:"main",fn:Ls,requiresIfExists:["offset"],data:{_skip:!1}};function Ue(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function _e(e){return[H,F,z,D].some(function(t){return e[t]>=0})}function Ys(e){var t=e.state,i=e.name,o=t.rects.reference,s=t.rects.popper,n=t.modifiersData.preventOverflow,l=Ot(t,{elementContext:"reference"}),r=Ot(t,{altBoundary:!0}),a=Ue(l,o),c=Ue(r,s,n),h=_e(a),p=_e(c);t.modifiersData[i]={referenceClippingOffsets:a,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":p})}const Ps={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Ys};function Xs(e,t,i){var o=j(e),s=[D,H].indexOf(o)>=0?-1:1,n=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,l=n[0],r=n[1];return l=l||0,r=(r||0)*s,[D,F].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function Rs(e){var t=e.state,i=e.options,o=e.name,s=i.offset,n=s===void 0?[0,0]:s,l=He.reduce(function(h,p){return h[p]=Xs(p,t.rects,n),h},{}),r=l[t.placement],a=r.x,c=r.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=a,t.modifiersData.popperOffsets.y+=c),t.modifiersData[o]=l}const Ms={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Rs};function Hs(e){var t=e.state,i=e.name;t.modifiersData[i]=Ge({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Ds={name:"popperOffsets",enabled:!0,phase:"read",fn:Hs,data:{}};function Zs(e){return e==="x"?"y":"x"}function Bs(e){var t=e.state,i=e.options,o=e.name,s=i.mainAxis,n=s===void 0?!0:s,l=i.altAxis,r=l===void 0?!1:l,a=i.boundary,c=i.rootBoundary,h=i.altBoundary,p=i.padding,m=i.tether,u=m===void 0?!0:m,x=i.tetherOffset,y=x===void 0?0:x,v=Ot(t,{boundary:a,rootBoundary:c,padding:p,altBoundary:h}),k=j(t.placement),O=dt(t.placement),w=!O,b=te(k),C=Zs(b),f=t.modifiersData.popperOffsets,g=t.rects.reference,I=t.rects.popper,E=typeof y=="function"?y(Object.assign({},t.rects,{placement:t.placement})):y,A=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),L=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,M={x:0,y:0};if(f){if(n){var T,_=b==="y"?H:D,K=b==="y"?z:F,X=b==="y"?"height":"width",B=f[b],pt=B+v[_],J=B-v[K],ut=u?-I[X]/2:0,Et=O===lt?g[X]:I[X],st=O===lt?-I[X]:-g[X],ft=t.elements.arrow,et=u&&ft?Qt(ft):{width:0,height:0},$=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:We(),nt=$[_],mt=$[K],G=Ct(0,g[X],et[X]),At=w?g[X]/2-ut-G-nt-A.mainAxis:Et-G-nt-A.mainAxis,zt=w?-g[X]/2+ut+G+mt+A.mainAxis:st+G+mt+A.mainAxis,St=t.elements.arrow&&It(t.elements.arrow),ne=St?b==="y"?St.clientTop||0:St.clientLeft||0:0,Ft=(T=L==null?void 0:L[b])!=null?T:0,re=B+At-Ft-ne,ae=B+zt-Ft,Nt=Ct(u?Ht(pt,re):pt,B,u?ot(J,ae):J);f[b]=Nt,M[b]=Nt-B}if(r){var Vt,le=b==="x"?H:D,ce=b==="x"?z:F,q=f[C],vt=C==="y"?"height":"width",jt=q+v[le],Lt=q-v[ce],rt=[H,D].indexOf(k)!==-1,gt=(Vt=L==null?void 0:L[C])!=null?Vt:0,Tt=rt?jt:q-g[vt]-I[vt]-gt+A.altAxis,Yt=rt?q+g[vt]+I[vt]-gt-A.altAxis:Lt,Pt=u&&rt?cs(Tt,q,Yt):Ct(u?Tt:jt,q,u?Yt:Lt);f[C]=Pt,M[C]=Pt-q}t.modifiersData[o]=M}}const Ws={name:"preventOverflow",enabled:!0,phase:"main",fn:Bs,requiresIfExists:["offset"]};function zs(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Fs(e){return e===Z(e)||!N(e)?ee(e):zs(e)}function Ns(e){var t=e.getBoundingClientRect(),i=ct(t.width)/e.offsetWidth||1,o=ct(t.height)/e.offsetHeight||1;return i!==1||o!==1}function Vs(e,t,i){i===void 0&&(i=!1);var o=N(t),s=N(t)&&Ns(t),n=tt(t),l=ht(e,s,i),r={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(o||!o&&!i)&&((V(t)!=="body"||oe(n))&&(r=Fs(t)),N(t)?(a=ht(t,!0),a.x+=t.clientLeft,a.y+=t.clientTop):n&&(a.x=ie(n))),{x:l.left+r.scrollLeft-a.x,y:l.top+r.scrollTop-a.y,width:l.width,height:l.height}}function js(e){var t=new Map,i=new Set,o=[];e.forEach(function(n){t.set(n.name,n)});function s(n){i.add(n.name);var l=[].concat(n.requires||[],n.requiresIfExists||[]);l.forEach(function(r){if(!i.has(r)){var a=t.get(r);a&&s(a)}}),o.push(n)}return e.forEach(function(n){i.has(n.name)||s(n)}),o}function $s(e){var t=js(e);return os.reduce(function(i,o){return i.concat(t.filter(function(s){return s.phase===o}))},[])}function Gs(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function Us(e){var t=e.reduce(function(i,o){var s=i[o.name];return i[o.name]=s?Object.assign({},s,o,{options:Object.assign({},s.options,o.options),data:Object.assign({},s.data,o.data)}):o,i},{});return Object.keys(t).map(function(i){return t[i]})}var Ke={placement:"bottom",modifiers:[],strategy:"absolute"};function Je(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function _s(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,o=i===void 0?[]:i,s=t.defaultOptions,n=s===void 0?Ke:s;return function(r,a,c){c===void 0&&(c=n);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ke,n),modifiersData:{},elements:{reference:r,popper:a},attributes:{},styles:{}},p=[],m=!1,u={state:h,setOptions:function(k){var O=typeof k=="function"?k(h.options):k;y(),h.options=Object.assign({},n,h.options,O),h.scrollParents={reference:it(r)?kt(r):r.contextElement?kt(r.contextElement):[],popper:kt(a)};var w=$s(Us([].concat(o,h.options.modifiers)));return h.orderedModifiers=w.filter(function(b){return b.enabled}),x(),u.update()},forceUpdate:function(){if(!m){var k=h.elements,O=k.reference,w=k.popper;if(Je(O,w)){h.rects={reference:Vs(O,It(w),h.options.strategy==="fixed"),popper:Qt(w)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(A){return h.modifiersData[A.name]=Object.assign({},A.data)});for(var b=0;b<h.orderedModifiers.length;b++){if(h.reset===!0){h.reset=!1,b=-1;continue}var C=h.orderedModifiers[b],f=C.fn,g=C.options,I=g===void 0?{}:g,E=C.name;typeof f=="function"&&(h=f({state:h,options:I,name:E,instance:u})||h)}}}},update:Gs(function(){return new Promise(function(v){u.forceUpdate(),v(h)})}),destroy:function(){y(),m=!0}};if(!Je(r,a))return u;u.setOptions(c).then(function(v){!m&&c.onFirstUpdate&&c.onFirstUpdate(v)});function x(){h.orderedModifiers.forEach(function(v){var k=v.name,O=v.options,w=O===void 0?{}:O,b=v.effect;if(typeof b=="function"){var C=b({state:h,name:k,instance:u,options:w}),f=function(){};p.push(C||f)}})}function y(){p.forEach(function(v){return v()}),p=[]}return u}}var Ks=[ys,Ds,gs,rs,Ms,Ts,Ws,us,Ps],Js=_s({defaultModifiers:Ks});class qs{constructor(t,i,o,s={}){ei(this,"updateHotspotPosition",(t,i)=>{this.currentActiveIndex=t,this.currentOrientation=i;const o=Bo(this.hotspotsConfig,t,i);this.hideHotspots(),o.forEach(s=>this.updateAndShowHotspot(s,t))});this.container=i,this.popper=null,this.popperInstance=null,this.hotspotsContainer=qi(this.container),this.hotspotsConfig=Vo(t),this.shouldHidePopper=!0,this.hidePopper=this.hidePopper.bind(this),this.forceHidePopper=this.forceHidePopper.bind(this),this.imageAspectRatio=o,this.hotspotElements=new Map,this.popperListeners=[],this.trigger=s.trigger||"hover";const{containerSize:n}=t[0];this.initialContainerSize=n||[i.offsetWidth,i.offsetHeight],this.initHotspots(),this.observeContainerResize()}observeContainerResize(){this.resizeObserver=new ResizeObserver(()=>{const t=this.container.offsetWidth,i=this.container.offsetHeight;this.updateHotspotsForResize(t,i)}),this.resizeObserver.observe(this.container)}updateHotspotsForResize(t,i){this.hotspotsConfig=jo({newWidth:t,newHeight:i,initialContainerSize:this.initialContainerSize,imageAspectRatio:this.imageAspectRatio,hotspotsConfig:this.hotspotsConfig}),this.updateHotspotPosition(this.currentActiveIndex,this.currentOrientation)}cleanupPopperListeners(){this.popperListeners.forEach(({element:t,event:i,handler:o})=>{t.removeEventListener(i,o)}),this.popperListeners=[]}showPopper({hotspotElement:t,content:i,id:o,keepOpen:s}){this.popperInstance&&this.hidePopper();const n={placement:"top",modifiers:Fo(this.container)};this.popper=No(i,o),this.popper.setAttribute("data-show",""),this.currentHotspotElement=t,t.setAttribute("aria-expanded","true"),t.setAttribute("aria-describedby",`cloudimage-360-popper-${o}`);const l=()=>{this.shouldHidePopper=!1},r=()=>{this.shouldHidePopper=!0,this.checkAndHidePopper()},a=()=>{this.shouldHidePopper=!0,this.checkAndHidePopper()},c=()=>{this.shouldHidePopper=!1,this.hidePopperTimeout&&clearTimeout(this.hidePopperTimeout)};this.popper.addEventListener("mouseenter",l),this.popper.addEventListener("mouseleave",r),t.addEventListener("mouseleave",a),t.addEventListener("mouseenter",c),this.popperListeners.push({element:this.popper,event:"mouseenter",handler:l},{element:this.popper,event:"mouseleave",handler:r},{element:t,event:"mouseleave",handler:a},{element:t,event:"mouseenter",handler:c}),this.popperInstance={...Js(t,this.popper,n),keepOpen:s,instanceId:o}}checkAndHidePopper(){var t;this.shouldHidePopper&&!((t=this.popperInstance)!=null&&t.keepOpen)&&(this.hidePopperTimeout=setTimeout(()=>{this.shouldHidePopper&&this.hidePopper()},ki))}hidePopper(){if(this.hidePopperTimeout&&(clearTimeout(this.hidePopperTimeout),this.hidePopperTimeout=null),this.cleanupPopperListeners(),this.currentHotspotElement&&(this.currentHotspotElement.setAttribute("aria-expanded","false"),this.currentHotspotElement.removeAttribute("aria-describedby"),this.currentHotspotElement=null),this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null),this.popper){this.popper.removeAttribute("data-show"),this.popper.setAttribute("aria-hidden","true");const t=this.popper;this.popper=null,setTimeout(()=>{t.remove()},Oi)}this.shouldHidePopper=!0}forceHidePopper(){this.shouldHidePopper=!0,this.popperInstance&&(this.popperInstance.keepOpen=!1),this.hidePopper()}createHotspot(t){const{id:i,content:o,keepOpen:s,onClick:n,label:l}=t,r=Wo(i,l);(n||o&&this.trigger==="click")&&(r.style.cursor="pointer"),r.onclick=a=>{var c;a.stopPropagation(),o&&this.trigger==="click"&&(((c=this.popperInstance)==null?void 0:c.instanceId)===i?this.hidePopper():this.showPopper({hotspotElement:r,content:o,id:i,keepOpen:s})),n==null||n(a,this.popperInstance,i)},o&&(this.trigger==="hover"&&(r.addEventListener("mouseenter",()=>this.showPopper({hotspotElement:r,content:o,id:i,keepOpen:s})),r.addEventListener("mouseleave",()=>{this.shouldHidePopper=!0,this.checkAndHidePopper()})),r.addEventListener("focus",()=>this.showPopper({hotspotElement:r,content:o,id:i,keepOpen:s})),r.addEventListener("blur",()=>{this.shouldHidePopper=!0,this.checkAndHidePopper()})),this.hotspotsContainer.appendChild(r)}hideHotspots(){this.hotspotsContainer.querySelectorAll(".cloudimage-360-hotspot").forEach(t=>{t.style.opacity=0,t.style.pointerEvents="none"})}updateAndShowHotspot(t,i){const{positions:o,id:s}=t,{x:n,y:l}=o[i]??{},r=this.hotspotsContainer.querySelector(`[data-hotspot-id="${s}"]`);r&&(r.style.translate=`${n}px ${l}px`,r.style.opacity=1,r.style.pointerEvents="all")}showHotspotById(t){const i=this.hotspotsConfig.find(s=>s.id===t);if(!i||!i.content)return;const o=this.hotspotsContainer.querySelector(`[data-hotspot-id="${t}"]`);o&&o.style.opacity==="1"&&this.showPopper({hotspotElement:o,content:i.content,id:t,keepOpen:i.keepOpen})}createAllHotspots(){this.hotspotsConfig.forEach(t=>this.createHotspot(t))}initHotspots(){this.createAllHotspots()}destroy(){this.hidePopperTimeout&&clearTimeout(this.hidePopperTimeout),this.resizeObserver.disconnect(),this.hidePopper(),this.hotspotElements.clear(),this.hotspotsContainer.innerHTML=""}}const qe=typeof navigator<"u"&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);class Wt{constructor(t,i,o){this.container=t,this.isClicked=!1,this.fullscreenView=!!o,this.imagesX=[],this.imagesY=[];const s=Math.round(window.devicePixelRatio||1);this.devicePixelRatio=qe?Math.min(s,2):s,this.id=t.id,this.movementStart={x:0,y:0},this.draggingDirection=null,this.isReady=!1,this.velocityX=0,this.velocityY=0,this.lastDragTime=0,this.lastDragX=0,this.lastDragY=0,this.inertiaAnimationId=null,this.hasInteracted=!1,this.currentZoomScale=1,this.touchDevice=To(),this.dragJustEnded=!1,this.isPinching=!1,this.initialPinchDistance=0,this.pinchZoomLevel=1,this.pinchZoomEmitted=!1,this.lastEmittedZoom=1,this.panOffsetX=0,this.panOffsetY=0,this.useMainThreadCanvas=qe,this.canvasWorker=this.useMainThreadCanvas?new Ro:new Xo,this.hotspotTimeline=null,this.hotspotTimelineIndicator=null,this.isAnimatingToFrame=!1,this.onMoveHandler=this.onMoveHandler.bind(this),this.destroy=this.destroy.bind(this),this.init(this.container,i)}closeImageBitmaps(t){!t||!Array.isArray(t)||t.forEach(i=>{var o;(o=i==null?void 0:i.bitmapImage)!=null&&o.close&&i.bitmapImage.close()})}emit(t,i={}){const o=this[t];typeof o=="function"&&o({...i,viewerId:this.id})}announce(t){to(this.ariaLiveRegion,t)}mouseDown(t){if(!this.isReady||this.glass)return;const{pageX:i,pageY:o}=t;this.hideHints(),this.hideHotspotPopper(),this.inertiaAnimationId&&(cancelAnimationFrame(this.inertiaAnimationId),this.inertiaAnimationId=null),this.autoplayJustStopped=!1,(this.autoplay||this.loopTimeoutId)&&(this.stopAutoplay(),this.autoplay=!1,this.autoplayJustStopped=!0),this.movementStart={x:i,y:o},this.isClicked=!0,this.isDragging=!1,this.inertia&&(this.velocityX=0,this.velocityY=0,this.lastDragTime=performance.now(),this.lastDragX=i,this.lastDragY=o)}mouseUp(){this.isReady&&(!this.isZoomed&&!this.autoplayJustStopped&&this.showAllIcons(),this.inertia&&this.isDragging&&(Math.abs(this.velocityX)>.1||Math.abs(this.velocityY)>.1)&&this.startInertia(),this.isDragging&&(this.emit("onDragEnd"),this.dragJustEnded=!0),this.movementStart={x:0,y:0},this.isClicked=!1,this.isDragging=!1,this.innerBox.style.cursor="grab")}startInertia(){const o=this.fullscreenView?document.body:this.container,s=this.dragSpeed/ve,n=s*(this.amountX/o.offsetWidth),l=s*(this.amountY/o.offsetHeight),r=()=>{if(this.velocityX*=.95,this.velocityY*=.95,Math.abs(this.velocityX)<.01&&Math.abs(this.velocityY)<.01){this.inertiaAnimationId=null;return}const a=this.velocityX*16,c=this.velocityY*16,h=Te({deltaX:a,deltaY:c,reversed:this.dragReverse,allowSpinX:this.allowSpinX,allowSpinY:this.allowSpinY});if(h){const p=this.allowSpinX?Math.max(1,Math.abs(Math.round(a*n))):0,m=this.allowSpinY?Math.max(1,Math.abs(Math.round(c*l))):0;(p>0||m>0)&&this.onMoveHandler(h,p,m)}this.inertiaAnimationId=requestAnimationFrame(r)};this.inertiaAnimationId=requestAnimationFrame(r)}drag(t,i){if(!this.isReady||!this.isClicked)return;const o=t-this.movementStart.x,s=i-this.movementStart.y;if(this.inertia){const m=performance.now(),u=m-this.lastDragTime;u>0&&u<100&&(this.velocityX=(t-this.lastDragX)/u,this.velocityY=(i-this.lastDragY)/u),this.lastDragTime=m,this.lastDragX=t,this.lastDragY=i}this.draggingDirection=Te({deltaX:o,deltaY:s,reversed:this.dragReverse,allowSpinX:this.allowSpinX,allowSpinY:this.allowSpinY})||this.draggingDirection;const n=this.fullscreenView?document.body:this.container,l=this.dragSpeed/ve,r=l*(this.amountX/n.offsetWidth),a=l*(this.amountY/n.offsetHeight),c=this.allowSpinX?Math.abs(Math.round(o*r)):0,h=this.allowSpinY?Math.abs(Math.round(s*a)):0;(this.allowSpinX&&c!==0||this.allowSpinY&&h!==0)&&(this.hasInteracted=!0,this.hideHotspotPopper(),this.onMoveHandler(this.draggingDirection,c,h),this.movementStart={x:t,y:i},setTimeout(()=>{this.isDragging||(this.isDragging=!0,this.emit("onDragStart"))},Ci))}mouseMove(t){!this.isReady||!this.isClicked&&!this.isZoomed||this.glass||(this.hideAllIcons(),this.drag(t.pageX,t.pageY),this.isZoomed&&this.applyZoom(t))}mouseClick(t){if(!(!this.isReady||this.isDragging)){if(this.dragJustEnded){this.dragJustEnded=!1;return}if(this.autoplayJustStopped){this.autoplayJustStopped=!1;return}if(this.glass&&this.magnified){this.removeGlass();return}this.pointerZoom&&!this.glass&&!this.touchDevice&&this.toggleZoom(t)}}loadHigherQualityImages(t,i){const o=bt(this.srcXConfig,t),s=this.allowSpinY?bt(this.srcYConfig,t):null;ye({cdnPathX:o,cdnPathY:s,configX:this.srcXConfig,configY:this.srcYConfig,onAllImagesLoad:(n,l)=>{this.closeImageBitmaps(this.imagesX),this.closeImageBitmaps(this.imagesY),this.imagesX=n,this.imagesY=l,i()},onError:n=>this.emit("onError",n)})}hideHotspots(){this.hotspotsInstance&&this.hotspotsInstance.hideHotspots()}hideHotspotPopper(){this.hotspotsInstance&&this.hotspotsInstance.forceHidePopper()}toggleZoom(t){if(this.isZoomed)this.showTransitionOverlay(),setTimeout(()=>{this.removeZoom()},me);else{let i=(this.fullscreenView||this.pointerZoom?document.body:this.container).offsetWidth;this.hideHotspots(),this.showLoadingSpinner(),this.loadHigherQualityImages(i,()=>{this.showTransitionOverlay(),setTimeout(()=>{this.applyZoom(t)},me)})}}removeZoom(){this.isZoomed=!1,this.updateView(),this.showAllIcons(),this.hideTransitionOverlay(),this.emit("onZoomOut"),this.announce("Zoomed out")}mouseLeave(){this.isZoomed&&this.removeZoom()}applyZoom(t){const{offsetX:i,offsetY:o}=Io(t,this.canvas,this.devicePixelRatio);this.isZoomed=!0,this.hideAllIcons(),this.hideLoadingSpinner(),this.hideTransitionOverlay(),this.updateView(this.pointerZoom,i,o),this.emit("onZoomIn",{zoomLevel:this.pointerZoom}),this.announce("Zoomed in. Move mouse to pan. Click to zoom out.")}touchOutside(t){if(!this.glass)return;!this.canvas.contains(t.target)&&this.removeGlass()}touchStart(t){if(!this.isReady||this.glass||!t.touches||!t.touches.length)return;const i=t.target;if(i&&i.closest&&(i.closest(".cloudimage-360-button")||i.closest(".cloudimage-360-hotspot-timeline-dot")||i.closest(".cloudimage-360-hotspot")))return;if(this.hideHints(),t.touches.length===2&&this.pinchZoom&&!this.isDragging){t.preventDefault(),this.isPinching=!0,this.isClicked=!1,this.inertiaAnimationId&&(cancelAnimationFrame(this.inertiaAnimationId),this.inertiaAnimationId=null);const n=t.touches[0],l=t.touches[1];if(this.initialPinchDistance=this.getPinchDistance(n,l),(this.autoplay||this.loopTimeoutId)&&(this.stopAutoplay(),this.autoplay=!1),!this.isZoomed&&this.pinchZoomLevel===1){const r=(this.fullscreenView?document.body:this.container).offsetWidth;this.hideHotspots(),this.loadHigherQualityImages(r,()=>{})}return}if(t.touches.length>1)return;const{pageX:o,pageY:s}=t.touches[0];this.inertiaAnimationId&&(cancelAnimationFrame(this.inertiaAnimationId),this.inertiaAnimationId=null),(this.autoplay||this.loopTimeoutId)&&(this.stopAutoplay(),this.autoplay=!1),this.hideAllIcons(),this.hideHotspotPopper(),this.movementStart={x:o,y:s},this.isClicked=!0,this.isDragging=!1,this.inertia&&(this.velocityX=0,this.velocityY=0,this.lastDragTime=performance.now(),this.lastDragX=o,this.lastDragY=s)}getPinchDistance(t,i){const o=t.pageX-i.pageX,s=t.pageY-i.pageY;return Math.sqrt(o*o+s*s)}getPinchCenter(t,i){return{x:(t.pageX+i.pageX)/2,y:(t.pageY+i.pageY)/2}}touchEnd(t){if(this.isReady){if(this.isPinching){if(!t.touches||t.touches.length<2){if(this.isPinching=!1,this.initialPinchDistance=0,this.pinchZoomLevel<=1){const i=this.pinchZoomEmitted;this.pinchZoomLevel=1,this.pinchZoomEmitted=!1,this.lastEmittedZoom=1,this.isZoomed=!1,this.panOffsetX=0,this.panOffsetY=0,this.showAllIcons(),this.updateView(),i&&this.emit("onZoomOut")}else if(this.canvas){const i=this.canvas.getBoundingClientRect();this.panOffsetX=i.width/2*this.devicePixelRatio,this.panOffsetY=i.height/2*this.devicePixelRatio}}return}this.showAllIcons(),this.inertia&&this.isDragging&&(Math.abs(this.velocityX)>.1||Math.abs(this.velocityY)>.1)&&this.startInertia(),this.movementStart={x:0,y:0},this.isClicked=!1,this.isDragging=!1}}touchMove(t){if(!this.isReady||this.glass)return;if(this.isPinching&&t.touches.length===2){t.preventDefault();const s=t.touches[0],n=t.touches[1],l=this.getPinchDistance(s,n);if(this.initialPinchDistance===0){this.initialPinchDistance=l;return}const r=l/this.initialPinchDistance,a=Math.max(1,Math.min(this.pinchZoomLevel*r,ge));if(this.initialPinchDistance=l,this.pinchZoomLevel=a,!this.canvas)return;const c=this.canvas.getBoundingClientRect(),h=c.width/2*this.devicePixelRatio,p=c.height/2*this.devicePixelRatio;a>1?(this.isZoomed=!0,this.hideAllIcons(),this.updateView(a,h,p),(!this.pinchZoomEmitted||a>this.lastEmittedZoom)&&(this.emit("onZoomIn",{zoomLevel:a}),this.pinchZoomEmitted=!0,this.lastEmittedZoom=a)):(this.isZoomed=!1,this.panOffsetX=0,this.panOffsetY=0,this.updateView());return}if(!this.isClicked||!t.touches||!t.touches[0])return;const{pageX:i,pageY:o}=t.touches[0];if(t.preventDefault(),this.isZoomed&&this.pinchZoomLevel>1){const s=i-this.movementStart.x,n=o-this.movementStart.y;this.panOffsetX-=s*this.devicePixelRatio,this.panOffsetY-=n*this.devicePixelRatio,this.movementStart={x:i,y:o},this.updateView(this.pinchZoomLevel,this.panOffsetX,this.panOffsetY);return}this.drag(i,o)}keyDown(t){if(!this.isReady)return;const{keyCode:i}=t,o=this.keysReverse;switch(this.autoplay&&this.stopAutoplay(),Le(i,this.allowSpinY)&&(this.hasInteracted=!0,this.hideAllIcons(),this.hideHints()),i){case 37:o?this.moveLeft():this.moveRight();break;case 39:o?this.moveRight():this.moveLeft();break;case 38:this.allowSpinY&&(t.preventDefault(),o?this.moveTop():this.moveBottom());break;case 40:this.allowSpinY&&(t.preventDefault(),o?this.moveBottom():this.moveTop());break}}keyUp(t){const{keyCode:i}=t;Le(i,this.allowSpinY)&&this.showAllIcons()}moveActiveXIndexUp(t){this.orientation=Y.X,this.activeImageX=(this.activeImageX+t)%this.amountX}moveActiveXIndexDown(t){this.orientation=Y.X,this.activeImageX=(this.activeImageX-t+this.amountX)%this.amountX}moveActiveYIndexUp(t){this.orientation=Y.Y,this.activeImageY=(this.activeImageY+t)%this.amountY}moveActiveYIndexDown(t){this.orientation=Y.Y,this.activeImageY=(this.activeImageY-t+this.amountY)%this.amountY}moveRight(t,i=1){t&&this.activeImageX>=this.imagesX.length-1||(this.moveActiveXIndexUp(i),this.isZoomed||this.updateView())}moveLeft(t,i=1){t&&this.activeImageX<=0||(this.moveActiveXIndexDown(i),this.isZoomed||this.updateView())}moveTop(t,i=1){t&&this.activeImageY>=this.imagesY.length-1||(this.moveActiveYIndexUp(i),this.isZoomed||this.updateView())}moveBottom(t,i=1){t&&this.activeImageY<=0||(this.moveActiveYIndexDown(i),this.isZoomed||this.updateView())}onMoveHandler(t,i=1,o=1){t==="right"?this.moveRight(this.stopAtEdges,i):t==="left"?this.moveLeft(this.stopAtEdges,i):t==="up"?this.moveTop(this.stopAtEdges,o):t==="down"&&this.moveBottom(this.stopAtEdges,o),this.emit("onSpin",{direction:t,activeImageX:this.activeImageX,activeImageY:this.activeImageY,amountX:this.amountX,amountY:this.amountY})}updateView(t,i,o){const s=this.orientation===Y.X?this.activeImageX:this.activeImageY,n=this.orientation===Y.X?this.imagesX[this.activeImageX]:this.imagesY[this.activeImageY];this.hotspotsInstance&&!this.isZoomed&&!this.autoplay&&this.hotspotsInstance.updateHotspotPosition(s,this.orientation),this.hotspotTimelineIndicator&&this.orientation===Y.X&&this.updateHotspotTimelinePosition(),this.drawImageOnCanvas(n,t,i,o)}updatePercentageInLoader(t=0){this.loader&&(this.loader.innerText=t+"%")}adaptCanvasSize(t){const{naturalWidth:i,naturalHeight:o}=t;this.imageAspectRatio=i/o;const s=this.fullscreenView?window.innerWidth:this.canvas.clientWidth,n=this.fullscreenView?window.innerHeight:this.canvas.clientHeight;this.canvasWorker.postMessage({action:"adaptCanvasSize",devicePixelRatio:this.devicePixelRatio,imageAspectRatio:this.imageAspectRatio,containerWidth:s,containerHeight:n})}drawImageOnCanvas(t,i=1,o=0,s=0){this.pendingDrawData={imageData:t,zoomScale:i,pointerX:o,pointerY:s},this.drawFrameRequested||(this.drawFrameRequested=!0,requestAnimationFrame(()=>{if(this.drawFrameRequested=!1,this.pendingDrawData){const{imageData:n,zoomScale:l,pointerX:r,pointerY:a}=this.pendingDrawData;this.canvasWorker.postMessage({action:"drawImageOnCanvas",imageData:n,zoomScale:l,pointerX:r,pointerY:a})}}))}pushImageToSet(t,i,o){o===Y.X?this.imagesX[i]=t:this.imagesY[i]=t}calculatePercentage(){const t=this.amountX+this.amountY,i=this.imagesX.length+this.imagesY.length;return Math.round(i/t*100)}onImageLoad(t,i,o){this.pushImageToSet(t,i,o),this.updatePercentageInLoader(this.calculatePercentage())}onFirstImageLoaded(t,i){this.createContainers(t),this.adaptCanvasSize(i),this.drawImageOnCanvas(i)}onAllImagesLoaded(){if(this.addAllIcons(),this.isReady=!0,this.amountX=this.imagesX.length,this.amountY=this.imagesY.length,this.activeImageX=this.autoplayReverse?this.amountX-1:0,this.activeImageY=this.autoplayReverse?this.amountY-1:0,this.hotspots&&(this.hotspotsInstance=new qs(this.hotspots,this.innerBox,this.imageAspectRatio,{trigger:this.hotspotTrigger}),this.addHotspotTimeline(),this.showHotspotTimeline()),this.emit("onLoad",{imagesX:this.imagesX.length,imagesY:this.imagesY.length}),this.emit("onReady"),this.announce("360 degree view loaded. Use mouse drag or arrow keys to rotate."),this.hints!==!1&&!this.autoplay){const t=this.hints===!0||this.hints===void 0?Ce(this.viewerConfig,this.touchDevice):this.hints;t&&t.length>0&&(this.hintsOverlay=Ie(this.innerBox,t),ke(this.hintsOverlay))}this.autoplay&&(this.hideAllIcons(),Yo(this.play.bind(this))())}magnify(t){t.stopPropagation();const{src:i}=this.orientation===Y.Y?this.imagesY[this.activeImageY]:this.imagesX[this.activeImageX],s=(this.fullscreenView?document.body:this.container).offsetWidth*this.magnifier,n=Mi(i,s);this.showLoadingSpinner(),this.createGlass(),yo(n,a=>{this.hideLoadingSpinner(),this.magnified=!0,xo(t,this.innerBox,this.offset,a,this.glass,this.magnifier)},a=>{this.hideLoadingSpinner(),this.removeGlass(),this.emit("onError",{error:{message:a.message,url:a.url},errorCount:1,totalImages:1,errors:[{message:a.message,url:a.url}]})})}openFullscreenModal(t){t.stopPropagation(),this.releaseMemory(),window.document.body.style.overflow="hidden";const i=_i(this.container);this.fullscreenInstance=new Wt(i,this.viewerConfig,!0),this.emit("onFullscreenOpen"),this.announce("Opened fullscreen mode. Press Escape to exit.")}closeFullscreenModal(t){t.stopPropagation(),this.fullscreenInstance&&(this.fullscreenInstance.destroy(),this.fullscreenInstance=null),document.body.removeChild(this.container.parentNode),window.document.body.style.overflow="visible",this.reloadImages(),this.emit("onFullscreenClose"),this.announce("Exited fullscreen mode")}play(){if(this.isClicked)return;this.hide360ViewCircleIcon(),this.emit("onAutoplayStart");const t=this.speed*36/(this.amountX+this.amountY),i={left:this.moveLeft.bind(this),right:this.moveRight.bind(this),top:this.moveTop.bind(this),bottom:this.moveBottom.bind(this)};this.loopTimeoutId=window.setInterval(()=>{if(this.playOnce&&Eo({autoplayBehavior:this.autoplayBehavior,activeImageX:this.activeImageX,activeImageY:this.activeImageY,amountX:this.amountX,amountY:this.amountY,autoplayReverse:this.autoplayReverse})){this.stopAutoplay();return}Ao({autoplayBehavior:this.autoplayBehavior,activeImageX:this.activeImageX,activeImageY:this.activeImageY,amountX:this.amountX,amountY:this.amountY,autoplayReverse:this.autoplayReverse,spinDirection:this.spinDirection})&&(this.spinDirection=Lo(this.spinDirection));const n=this.spinDirection==="y";Oo({autoplayBehavior:this.autoplayBehavior,spinY:n,reversed:this.autoplayReverse,loopTriggers:i})},t)}stopAutoplay(){if(this.showAllIcons(),this.autoplay=!1,window.clearTimeout(this.loopTimeoutId),this.loopTimeoutId=null,this.emit("onAutoplayStop"),this.hints!==!1&&!this.hintsOverlay&&!this.hintsHidden){const t=this.hints===!0?Ce(this.viewerConfig,this.touchDevice):this.hints;t&&t.length>0&&(this.hintsOverlay=Ie(this.innerBox,t),ke(this.hintsOverlay))}}destroy(){this.stopAutoplay(),this.inertiaAnimationId&&(cancelAnimationFrame(this.inertiaAnimationId),this.inertiaAnimationId=null),this.removeEvents(),this.closeImageBitmaps(this.imagesX),this.closeImageBitmaps(this.imagesY),this.imagesX=[],this.imagesY=[],this.canvasWorker&&(this.canvasWorker.terminate(),this.canvasWorker=null),this.hotspotsInstance&&this.hotspotsInstance.destroy(),this.hintsOverlay&&this.hintsOverlay.parentNode&&(this.hintsOverlay.parentNode.removeChild(this.hintsOverlay),this.hintsOverlay=null),this.hotspotTimeline&&this.hotspotTimeline.parentNode&&(this.hotspotTimeline.parentNode.removeChild(this.hotspotTimeline),this.hotspotTimeline=null,this.hotspotTimelineIndicator=null),this.container&&(this.container.classList.remove("ci360-theme-dark"),this.container.innerHTML="")}releaseMemory(){this.stopAutoplay(),this.closeImageBitmaps(this.imagesX),this.closeImageBitmaps(this.imagesY),this.imagesX=[],this.imagesY=[],this.isMemoryReleased=!0}reloadImages(){if(!this.isMemoryReleased)return;this.isMemoryReleased=!1;const t=this.container.offsetWidth;this.loadHigherQualityImages(t,()=>{this.updateView()})}addInitialIcon(){this.initialIcon||this.hide360Logo||(this.initialIcon=Fi(this.logoSrc),this.innerBox.appendChild(this.initialIcon))}showInitialIcon(){!this.initialIcon||this.hasInteracted||(this.initialIcon.style.opacity=1)}hideInitialIcon(){this.initialIcon&&(this.initialIcon.style.opacity=0)}createGlass(){this.hideAllIcons(),this.glass=document.createElement("div"),this.innerBox.appendChild(this.glass),this.innerBox.style.cursor="default"}removeGlass(){this.showAllIcons(),this.innerBox.removeChild(this.glass),this.glass=null,this.magnified=!1}addMagnifierIcon(){this.magnifier&&(this.magnifierIcon=Gi(),this.magnifierIcon.onclick=this.magnify.bind(this),this.iconsContainer.appendChild(this.magnifierIcon))}showMagnifierIcon(){this.magnifierIcon&&(this.magnifierIcon.style.visibility="visible",this.magnifierIcon.style.opacity=1)}hideMagnifierIcon(){this.magnifierIcon&&(this.magnifierIcon.style.visibility="hidden",this.magnifierIcon.style.opacity=0)}addFullscreenIcon(){this.fullscreen&&(this.fullscreenIcon=ji(),this.fullscreenIcon.onclick=this.openFullscreenModal.bind(this),this.iconsContainer.appendChild(this.fullscreenIcon))}addCloseFullscreenIcon(){this.fullscreenCloseIcon=Vi(),this.fullscreenCloseIcon.onclick=this.closeFullscreenModal.bind(this),this.iconsContainer.appendChild(this.fullscreenCloseIcon)}showFullscreenIcon(){this.fullscreenIcon&&(this.fullscreenIcon.style.opacity=1)}hideFullscreenIcon(){this.fullscreenIcon&&(this.fullscreenIcon.style.opacity=0)}add360ViewCircleIcon(){this.view360CircleIcon||(this.view360CircleIcon=Wi(this.bottomCircleOffset),this.innerBox.appendChild(this.view360CircleIcon))}show360ViewCircleIcon(){this.view360CircleIcon&&(this.view360CircleIcon.style.opacity=1)}hide360ViewCircleIcon(){this.view360CircleIcon&&(this.view360CircleIcon.style.opacity=0)}addLoadingSpinner(){this.loadingSpinner=Ki(),this.innerBox.appendChild(this.loadingSpinner)}showLoadingSpinner(){this.loadingSpinner&&(this.hideAllIcons(),this.loadingSpinner.style.opacity=1)}createTransitionOverlay(){this.transitionOverlay=Ji(),this.innerBox.appendChild(this.transitionOverlay)}showTransitionOverlay(){this.transitionOverlay&&(this.hideAllIcons(),this.transitionOverlay.style.opacity=1)}hideTransitionOverlay(){this.transitionOverlay&&(this.transitionOverlay.style.opacity=0)}hideLoadingSpinner(){this.loadingSpinner&&(this.loadingSpinner.style.opacity=0)}hideHints(){!this.hintsOverlay||this.hintsHidden||(this.hintsHidden=!0,oo(this.hintsOverlay))}addHotspotTimeline(){if(!this.hotspots||this.hotspotTimeline)return;const t=lo(this.container,this.amountX,this.hotspots);if(!t)return;this.hotspotTimeline=t.element,this.hotspotTimelineIndicator=t.indicator,this.hotspotTimeline.querySelectorAll(".cloudimage-360-hotspot-timeline-dot").forEach(o=>{o.addEventListener("click",s=>{s.stopPropagation();const n=parseInt(o.getAttribute("data-frame"),10),l=o.getAttribute("data-hotspot-id");isNaN(n)||this.animateToFrame(n,l)})}),this.updateHotspotTimelinePosition()}showHotspotTimeline(){ho(this.hotspotTimeline)}hideHotspotTimeline(){po(this.hotspotTimeline)}updateHotspotTimelinePosition(){co(this.hotspotTimelineIndicator,this.activeImageX,this.amountX)}animateToFrame(t,i){if(this.hotspotsInstance&&this.hotspotsInstance.hidePopper(),this.isAnimatingToFrame||t===this.activeImageX){t===this.activeImageX&&i&&this.hotspotsInstance&&this.hotspotTimelineOnClick&&this.hotspotsInstance.showHotspotById(i);return}this.isAnimatingToFrame=!0,this.hasInteracted=!0,(this.autoplay||this.loopTimeoutId)&&(this.stopAutoplay(),this.autoplay=!1),this.inertiaAnimationId&&(cancelAnimationFrame(this.inertiaAnimationId),this.inertiaAnimationId=null);const o=this.activeImageX,s=(t-o+this.amountX)%this.amountX,n=(o-t+this.amountX)%this.amountX,l=s<=n,r=l?s:n;if(r===0){this.isAnimatingToFrame=!1;return}const a=30;let c=r;const h=()=>{if(c<=0){this.isAnimatingToFrame=!1,i&&this.hotspotsInstance&&this.hotspotTimelineOnClick&&setTimeout(()=>{this.hotspotsInstance.showHotspotById(i)},50);return}l?this.moveRight():this.moveLeft(),c--,c>0?setTimeout(h,a):(this.isAnimatingToFrame=!1,i&&this.hotspotsInstance&&this.hotspotTimelineOnClick&&setTimeout(()=>{this.hotspotsInstance.showHotspotById(i)},50))};h()}remove360ViewCircleIcon(){this.view360CircleIcon&&(this.innerBox.removeChild(this.view360CircleIcon),this.view360CircleIcon=null)}addAllIcons(){this.removeLoader(),this.iconsContainer&&(this.innerBox.style.cursor="grab",this.pointerZoom&&(this.createTransitionOverlay(),this.addLoadingSpinner()),!this.fullscreenView&&!this.touchDevice&&this.addMagnifierIcon(),this.fullscreenView||this.addFullscreenIcon(),this.initialIconShown&&this.addInitialIcon(),this.bottomCircle&&this.add360ViewCircleIcon())}showAllIcons(){this.showInitialIcon(),this.show360ViewCircleIcon(),this.showMagnifierIcon(),this.showFullscreenIcon(),this.showHotspotTimeline()}hideAllIcons(){this.hideInitialIcon(),this.hide360ViewCircleIcon(),this.hideMagnifierIcon(),this.hideFullscreenIcon(),this.hideHotspotTimeline()}removeLoader(){this.loader&&(this.innerBox.removeChild(this.loader),this.loader=null)}attachEvents(t,i,o){t&&this.addMouseEvents(),i&&this.addTouchEvents(),o&&this.addKeyboardEvents(),this.addEscKeyHandler()}removeEvents(){this.removeMouseEvents(),this.removeTouchEvents(),this.removeKeyboardEvents(),this.removeEscKeyHandler()}addMouseEvents(){this.boundMouseClick=this.mouseClick.bind(this),this.boundMouseDown=this.mouseDown.bind(this),this.boundMouseMove=ue(this.mouseMove.bind(this),fe),this.boundMouseUp=this.mouseUp.bind(this),this.boundMouseLeave=this.mouseLeave.bind(this),this.innerBox.addEventListener("click",this.boundMouseClick),this.innerBox.addEventListener("mousedown",this.boundMouseDown),this.innerBox.addEventListener("mouseleave",this.boundMouseLeave),document.addEventListener("mousemove",this.boundMouseMove),document.addEventListener("mouseup",this.boundMouseUp)}addTouchEvents(){this.boundTouchOutside=this.touchOutside.bind(this),this.boundTouchStart=this.touchStart.bind(this),this.boundTouchEnd=this.touchEnd.bind(this),this.boundTouchMove=ue(this.touchMove.bind(this),fe),document.addEventListener("touchstart",this.boundTouchOutside),this.container.addEventListener("touchstart",this.boundTouchStart),this.container.addEventListener("touchend",this.boundTouchEnd),this.container.addEventListener("touchmove",this.boundTouchMove)}addKeyboardEvents(){this.boundKeyDown=this.keyDown.bind(this),this.boundKeyUp=this.keyUp.bind(this),document.addEventListener("keydown",this.boundKeyDown),document.addEventListener("keyup",this.boundKeyUp)}addEscKeyHandler(){this.boundEscHandler=t=>{t.keyCode===27&&(this.fullscreenView?this.closeFullscreenModal(t):this.isZoomed?this.removeZoom():this.glass&&this.removeGlass())},document.addEventListener("keydown",this.boundEscHandler)}removeEscKeyHandler(){document.removeEventListener("keydown",this.boundEscHandler)}removeMouseEvents(){this.innerBox.removeEventListener("click",this.boundMouseClick),this.innerBox.removeEventListener("mousedown",this.boundMouseDown),this.innerBox.removeEventListener("mouseleave",this.boundMouseLeave),document.removeEventListener("mousemove",this.boundMouseMove),document.removeEventListener("mouseup",this.boundMouseUp)}removeTouchEvents(){document.removeEventListener("touchstart",this.boundTouchOutside),this.container.removeEventListener("touchstart",this.boundTouchStart),this.container.removeEventListener("touchend",this.boundTouchEnd),this.container.removeEventListener("touchmove",this.boundTouchMove)}removeKeyboardEvents(){document.removeEventListener("keydown",this.boundKeyDown),document.removeEventListener("keyup",this.boundKeyUp)}createContainers(t){if(this.iconsContainer=we(this.innerBox),this.canvas=Ni(this.innerBox,t),this.loader=Ui(this.innerBox),this.ariaLiveRegion=Qi(this.innerBox),this.useMainThreadCanvas)this.canvasWorker.postMessage({action:"initCanvas",offscreen:this.canvas,devicePixelRatio:this.devicePixelRatio});else{const i=this.canvas.transferControlToOffscreen();this.canvasWorker.postMessage({action:"initCanvas",offscreen:i,devicePixelRatio:this.devicePixelRatio},[i])}this.fullscreenView&&this.addCloseFullscreenIcon(),Gt(this.innerBox,".cloudimage-360-placeholder")}update(t){this.isReady&&(this.stopAutoplay(),Gt(this.innerBox,".cloudimage-360-icons-container"),this.init(this.container,t,!0),this.iconsContainer=we(this.innerBox),this.onAllImagesLoaded())}init(t,i,o){const s=i?Ti(i):Si(t),{folder:n,apiVersion:l,filenameX:r,filenameY:a,imageListX:c,imageListY:h,indexZeroBase:p,amountX:m,amountY:u,draggable:x=!0,swipeable:y=!0,keys:v,keysReverse:k,bottomCircleOffset:O,autoplay:w,autoplayBehavior:b,playOnce:C,speed:f,autoplayReverse:g,fullscreen:I,magnifier:E,ciToken:A,ciFilters:L,ciTransformation:M,lazyload:T,dragSpeed:_,stopAtEdges:K,pointerZoom:X,imageInfo:B="black",initialIconShown:pt,bottomCircle:J,hotspots:ut,hotspotTrigger:Et="hover",dragReverse:st,hide360Logo:ft,logoSrc:et,inertia:$,pinchZoom:nt,hints:mt,theme:G,hotspotTimelineOnClick:At=!0,aspectRatio:zt,onReady:St,onLoad:ne,onSpin:Ft,onAutoplayStart:re,onAutoplayStop:ae,onFullscreenOpen:Nt,onFullscreenClose:Vt,onZoomIn:le,onZoomOut:ce,onDragStart:q,onDragEnd:vt,onError:jt}=s,Lt={ciToken:A,ciFilters:L,ciTransformation:M},rt=Ut(c,[]),gt=Ut(h,[]);if(this.viewerConfig=s,this.amountX=rt.length||m,this.amountY=gt.length||u,this.allowSpinX=!!this.amountX,this.allowSpinY=!!this.amountY,this.activeImageX=g?this.amountX-1:0,this.activeImageY=g?this.amountY-1:0,this.bottomCircleOffset=O,this.autoplay=w,this.autoplayBehavior=b,this.playOnce=C,this.speed=f,this.autoplayReverse=g,this.fullscreen=I,this.magnifier=E>1?Math.min(E,Ai):0,this.dragSpeed=Math.max(_,Ei),this.stopAtEdges=K,this.ciParams=Lt,this.apiVersion=l,this.pointerZoom=X>1?Math.min(X,ge):null,this.keysReverse=k,this.info=B,this.keys=v,this.innerBox=this.innerBox??$i(this.container),zt&&(this.container.style.aspectRatio=zt),this.initialIconShown=pt,this.bottomCircle=J,this.spinDirection=So(this.autoplayBehavior,this.allowSpinX,this.allowSpinY),this.dragReverse=st,this.hotspots=ut,this.hotspotTrigger=Et,this.hide360Logo=ft,this.logoSrc=et,this.inertia=$,this.pinchZoom=nt,this.hints=mt,this.hotspotTimelineOnClick=At,G==="dark"?this.container.classList.add("ci360-theme-dark"):G==="light"&&this.container.classList.remove("ci360-theme-dark"),this.onReady=St,this.onLoad=ne,this.onSpin=Ft,this.onAutoplayStart=re,this.onAutoplayStop=ae,this.onFullscreenOpen=Nt,this.onFullscreenClose=Vt,this.onZoomIn=le,this.onZoomOut=ce,this.onDragStart=q,this.onDragEnd=vt,this.onError=jt,this.srcXConfig={folder:n,filename:r,imageList:rt,container:t,innerBox:this.innerBox,apiVersion:l,ciParams:Lt,lazyload:T,amount:this.amountX,indexZeroBase:p,autoplayReverse:g,orientation:Y.X},this.srcYConfig={...this.srcXConfig,filename:a,imageList:gt,orientation:Y.Y,amount:this.amountY},o&&this.removeEvents(),this.attachEvents(x,y,v),o)return;const Tt=(this.fullscreenView?document.body:this.container).offsetWidth,Yt=this.allowSpinX&&!rt.length?bt(this.srcXConfig,Tt):null,Pt=this.allowSpinY&&!gt.length?bt(this.srcYConfig,Tt):null,ti=Qs=>{ye({cdnPathX:Yt,cdnPathY:Pt,configX:this.srcXConfig,configY:this.srcYConfig,onImageLoad:(Xt,tn,en)=>this.onImageLoad(Xt,tn,en),onFirstImageLoad:Xt=>this.onFirstImageLoaded(Qs,Xt),onAllImagesLoad:this.onAllImagesLoaded.bind(this),onError:Xt=>this.emit("onError",Xt)})};this.allowSpinX?Ee(Yt,this.srcXConfig,ti):this.allowSpinY&&Ee(Pt,this.srcYConfig,ti)}}class Qe{constructor(){this.views=new Map,this.initAll=this.initAll.bind(this),this.getViews=this.getViews.bind(this),this.memoryObserver=null}generateId(){return`ci360-${Math.random().toString(36).slice(2,11)}`}init(t,i,o){if(!t)return;const s=t.id||this.generateId();t.id||(t.id=s);const n=new Wt(t,i,o);return this.views.set(s,n),n}initAll(t="cloudimage-360"){[...document.querySelectorAll(`.${t}`)].filter(Boolean).forEach(o=>{const s=o.id||this.generateId();o.id||(o.id=s);const n=new Wt(o);this.views.set(s,n)})}destroy(t){const i=this.getViewById(t);i&&(i.destroy(),this.views.delete(t))}destroyAll(){this.views.forEach(t=>{t.destroy()}),this.views.clear()}getViewById(t){return this.views.get(t)}getViews(){return Array.from(this.views.values())}updateView(t,i){const o=this.getViewById(t);if(!o)return null;const s={...o.viewerConfig,...i};o.destroy();const n=document.getElementById(t);return this.init(n,s)}enableMemoryManagement(t={}){this.memoryObserver&&this.memoryObserver.disconnect();const i=t.rootMargin||"200px";this.memoryObserver=new IntersectionObserver(o=>{o.forEach(s=>{const n=this.getViewById(s.target.id);n&&(s.isIntersecting?n.isMemoryReleased&&n.reloadImages():!n.isMemoryReleased&&n.isReady&&n.releaseMemory())})},{rootMargin:i}),this.views.forEach((o,s)=>{const n=document.getElementById(s);n&&this.memoryObserver.observe(n)}),this.boundVisibilityHandler=()=>{document.hidden?this.views.forEach(o=>{!o.isMemoryReleased&&o.isReady&&o.releaseMemory()}):this.views.forEach((o,s)=>{if(o.isMemoryReleased){const n=document.getElementById(s);if(n){const l=n.getBoundingClientRect();l.top<window.innerHeight&&l.bottom>0&&o.reloadImages()}}})},document.addEventListener("visibilitychange",this.boundVisibilityHandler)}disableMemoryManagement(){this.memoryObserver&&(this.memoryObserver.disconnect(),this.memoryObserver=null),this.boundVisibilityHandler&&(document.removeEventListener("visibilitychange",this.boundVisibilityHandler),this.boundVisibilityHandler=null)}}return window.CI360=Qe,Qe}();
